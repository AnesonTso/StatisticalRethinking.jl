<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>clip-14-20 · StatisticalRethinking.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>StatisticalRethinking.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><a class="toctext" href="../../layout/">Layout</a></li><li><a class="toctext" href="../../versions/">Versions</a></li><li><a class="toctext" href="../../acknowledgements/">Acknowledgements</a></li><li><a class="toctext" href="../../references/">References</a></li><li><span class="toctext">Chapter 00</span><ul><li><a class="toctext" href="../../00/clip-01-03/">clip-01-03</a></li><li><a class="toctext" href="../../00/clip-04-05/">clip-04-05</a></li></ul></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/clip-01-02/">clip-01-02</a></li><li><a class="toctext" href="../../02/clip-03-05/">clip-03-05</a></li><li><a class="toctext" href="../../02/clip-06-07/">clip-06-07</a></li><li><a class="toctext" href="../../02/m2.1s/">m2.1s</a></li></ul></li><li><span class="toctext">Chapter 03</span><ul><li><a class="toctext" href="../../03/clip-01/">clip-01</a></li><li><a class="toctext" href="../../03/clip-02-05/">clip-02-05</a></li><li><a class="toctext" href="../../03/clip-05s/">clip-05s</a></li><li><a class="toctext" href="../../03/clip-06-16s/">clip-06-16s</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../m4.1s/">m4.1s</a></li><li><a class="toctext" href="../clip-01-06/">clip-01-06</a></li><li><a class="toctext" href="../clip-07-13s/">clip-07-13s</a></li><li class="current"><a class="toctext" href>clip-14-20</a><ul class="internal"></ul></li><li><a class="toctext" href="../clip-21-23/">clip-21-23</a></li><li><a class="toctext" href="../clip-24-29s/">clip-24-29s</a></li><li><a class="toctext" href="../clip-30s/">clip-30s</a></li><li><a class="toctext" href="../clip-38s/">clip-38s</a></li><li><a class="toctext" href="../clip-43s/">clip-43s</a></li><li><a class="toctext" href="../clip-45-47s/">clip-45-47s</a></li><li><a class="toctext" href="../clip-48-54s/">clip-48-54s</a></li><li><a class="toctext" href="../m4.2s/">m4.2s</a></li><li><a class="toctext" href="../m4.3s/">m4.3s</a></li><li><a class="toctext" href="../m4.4s/">m4.4s</a></li><li><a class="toctext" href="../m4.5s/">m4.5s</a></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 04</li><li><a href>clip-14-20</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/StatisticalRethinking.jl/blob/master/scripts/04/clip-14-20.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>clip-14-20</span><a class="fa fa-bars" href="#"></a></div></header><p>Load Julia packages (libraries) needed  for the snippets in chapter 0</p><div><pre><code class="language-julia">using StatisticalRethinking, CmdStan, StanMCMCChains
gr(size=(500,500));</code></pre><pre><code class="language-none">Plots.GRBackend()</code></pre></div><p>CmdStan uses a tmp directory to store the output of cmdstan</p><div><pre><code class="language-julia">ProjDir = rel_path(&quot;..&quot;, &quot;scripts&quot;, &quot;04&quot;)
cd(ProjDir)</code></pre></div><h3><a class="nav-anchor" id="snippet-4.7-1" href="#snippet-4.7-1">snippet 4.7</a></h3><div><pre><code class="language-julia">howell1 = CSV.read(rel_path(&quot;..&quot;, &quot;data&quot;, &quot;Howell1.csv&quot;), delim=&#39;;&#39;)
df = convert(DataFrame, howell1);</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>544 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr><tr><th>6</th><td>163.83</td><td>62.9926</td><td>35.0</td><td>1</td></tr><tr><th>7</th><td>149.225</td><td>38.2435</td><td>32.0</td><td>0</td></tr><tr><th>8</th><td>168.91</td><td>55.48</td><td>27.0</td><td>1</td></tr><tr><th>9</th><td>147.955</td><td>34.8699</td><td>19.0</td><td>0</td></tr><tr><th>10</th><td>165.1</td><td>54.4877</td><td>54.0</td><td>1</td></tr><tr><th>11</th><td>154.305</td><td>49.8951</td><td>47.0</td><td>0</td></tr><tr><th>12</th><td>151.13</td><td>41.2202</td><td>66.0</td><td>1</td></tr><tr><th>13</th><td>144.78</td><td>36.0322</td><td>73.0</td><td>0</td></tr><tr><th>14</th><td>149.9</td><td>47.7</td><td>20.0</td><td>0</td></tr><tr><th>15</th><td>150.495</td><td>33.8493</td><td>65.3</td><td>0</td></tr><tr><th>16</th><td>163.195</td><td>48.5627</td><td>36.0</td><td>1</td></tr><tr><th>17</th><td>157.48</td><td>42.3258</td><td>44.0</td><td>1</td></tr><tr><th>18</th><td>143.942</td><td>38.3569</td><td>31.0</td><td>0</td></tr><tr><th>19</th><td>121.92</td><td>19.6179</td><td>12.0</td><td>1</td></tr><tr><th>20</th><td>105.41</td><td>13.948</td><td>8.0</td><td>0</td></tr><tr><th>21</th><td>86.36</td><td>10.4893</td><td>6.5</td><td>0</td></tr><tr><th>22</th><td>161.29</td><td>48.9879</td><td>39.0</td><td>1</td></tr><tr><th>23</th><td>156.21</td><td>42.7227</td><td>29.0</td><td>0</td></tr><tr><th>24</th><td>129.54</td><td>23.5868</td><td>13.0</td><td>1</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><h3><a class="nav-anchor" id="snippet-4.8-1" href="#snippet-4.8-1">snippet 4.8</a></h3><p>Use only adults</p><div><pre><code class="language-julia">df2 = filter(row -&gt; row[:age] &gt;= 18, df);</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>352 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr><tr><th>6</th><td>163.83</td><td>62.9926</td><td>35.0</td><td>1</td></tr><tr><th>7</th><td>149.225</td><td>38.2435</td><td>32.0</td><td>0</td></tr><tr><th>8</th><td>168.91</td><td>55.48</td><td>27.0</td><td>1</td></tr><tr><th>9</th><td>147.955</td><td>34.8699</td><td>19.0</td><td>0</td></tr><tr><th>10</th><td>165.1</td><td>54.4877</td><td>54.0</td><td>1</td></tr><tr><th>11</th><td>154.305</td><td>49.8951</td><td>47.0</td><td>0</td></tr><tr><th>12</th><td>151.13</td><td>41.2202</td><td>66.0</td><td>1</td></tr><tr><th>13</th><td>144.78</td><td>36.0322</td><td>73.0</td><td>0</td></tr><tr><th>14</th><td>149.9</td><td>47.7</td><td>20.0</td><td>0</td></tr><tr><th>15</th><td>150.495</td><td>33.8493</td><td>65.3</td><td>0</td></tr><tr><th>16</th><td>163.195</td><td>48.5627</td><td>36.0</td><td>1</td></tr><tr><th>17</th><td>157.48</td><td>42.3258</td><td>44.0</td><td>1</td></tr><tr><th>18</th><td>143.942</td><td>38.3569</td><td>31.0</td><td>0</td></tr><tr><th>19</th><td>161.29</td><td>48.9879</td><td>39.0</td><td>1</td></tr><tr><th>20</th><td>156.21</td><td>42.7227</td><td>29.0</td><td>0</td></tr><tr><th>21</th><td>146.4</td><td>35.4936</td><td>56.0</td><td>1</td></tr><tr><th>22</th><td>148.59</td><td>37.9033</td><td>45.0</td><td>0</td></tr><tr><th>23</th><td>147.32</td><td>35.4652</td><td>19.0</td><td>0</td></tr><tr><th>24</th><td>147.955</td><td>40.313</td><td>29.0</td><td>1</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><p>Show first 5 rows of DataFrame df</p><div><pre><code class="language-julia">first(df2, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>5 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.14-1" href="#Snippet-4.14-1">Snippet 4.14</a></h3><p>Generate approximate probabilities</p><div><pre><code class="language-julia">struct Post
  mu::Float64
  sigma::Float64
  ll:: Float64
  prod::Float64
  prob::Float64
end

mu_list = repeat(range(140, 160, length=200), 200);
sigma_list = repeat(range(4, 9, length=200), inner=200);

ll = zeros(40000);
for i in 1:40000
    d1 = Normal(mu_list[i], sigma_list[i])
    ll[i] = sum(log.(pdf.(d1, df2[:height])))
end

d2 = Normal(178.0, 20.0)
d3 = Uniform(0, 50)
prod = ll + log.(pdf.(d2, mu_list)) + log.(pdf.(d3, sigma_list))
prob = exp.(prod .- maximum(prod))
post = DataFrame(mu=mu_list, sigma=sigma_list, ll=ll, prod=prod, prob=prob)
first(post, 10)</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10 rows × 5 columns</p><tr><th>1</th><td>140.0</td><td>4.0</td><td>-3812.78</td><td>-3822.41</td><td>0.0</td></tr><tr><th>2</th><td>140.101</td><td>4.0</td><td>-3780.61</td><td>-3790.23</td><td>0.0</td></tr><tr><th>3</th><td>140.201</td><td>4.0</td><td>-3748.67</td><td>-3758.28</td><td>0.0</td></tr><tr><th>4</th><td>140.302</td><td>4.0</td><td>-3716.95</td><td>-3726.55</td><td>0.0</td></tr><tr><th>5</th><td>140.402</td><td>4.0</td><td>-3685.45</td><td>-3695.05</td><td>0.0</td></tr><tr><th>6</th><td>140.503</td><td>4.0</td><td>-3654.18</td><td>-3663.76</td><td>0.0</td></tr><tr><th>7</th><td>140.603</td><td>4.0</td><td>-3623.13</td><td>-3632.7</td><td>0.0</td></tr><tr><th>8</th><td>140.704</td><td>4.0</td><td>-3592.3</td><td>-3601.86</td><td>0.0</td></tr><tr><th>9</th><td>140.804</td><td>4.0</td><td>-3561.69</td><td>-3571.24</td><td>0.0</td></tr><tr><th>10</th><td>140.905</td><td>4.0</td><td>-3531.3</td><td>-3540.85</td><td>0.0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.15-1" href="#Snippet-4.15-1">Snippet 4.15</a></h3><p>Sample post</p><div><pre><code class="language-julia">samples = post[sample(1:size(post, 1), Weights(post[:prob]), 10000, replace=true), :]</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10,000 rows × 5 columns</p><tr><th>1</th><td>154.573</td><td>8.37186</td><td>-1221.52</td><td>-1230.04</td><td>0.120615</td></tr><tr><th>2</th><td>153.467</td><td>7.66834</td><td>-1223.25</td><td>-1231.83</td><td>0.0200912</td></tr><tr><th>3</th><td>154.271</td><td>7.94472</td><td>-1219.96</td><td>-1228.49</td><td>0.567063</td></tr><tr><th>4</th><td>155.075</td><td>7.46734</td><td>-1220.56</td><td>-1229.05</td><td>0.324598</td></tr><tr><th>5</th><td>154.372</td><td>7.99497</td><td>-1219.93</td><td>-1228.46</td><td>0.585094</td></tr><tr><th>6</th><td>154.171</td><td>7.56784</td><td>-1220.13</td><td>-1228.66</td><td>0.475904</td></tr><tr><th>7</th><td>154.472</td><td>7.69347</td><td>-1219.46</td><td>-1227.98</td><td>0.943607</td></tr><tr><th>8</th><td>155.075</td><td>8.22111</td><td>-1221.28</td><td>-1229.76</td><td>0.158933</td></tr><tr><th>9</th><td>154.372</td><td>7.99497</td><td>-1219.93</td><td>-1228.46</td><td>0.585094</td></tr><tr><th>10</th><td>155.075</td><td>7.69347</td><td>-1220.09</td><td>-1228.58</td><td>0.518417</td></tr><tr><th>11</th><td>154.372</td><td>7.66834</td><td>-1219.58</td><td>-1228.11</td><td>0.83134</td></tr><tr><th>12</th><td>154.372</td><td>7.54271</td><td>-1219.78</td><td>-1228.3</td><td>0.680833</td></tr><tr><th>13</th><td>155.377</td><td>7.54271</td><td>-1221.5</td><td>-1229.97</td><td>0.128669</td></tr><tr><th>14</th><td>155.176</td><td>7.44221</td><td>-1220.99</td><td>-1229.47</td><td>0.211918</td></tr><tr><th>15</th><td>154.472</td><td>7.79397</td><td>-1219.47</td><td>-1227.99</td><td>0.931322</td></tr><tr><th>16</th><td>154.975</td><td>7.46734</td><td>-1220.29</td><td>-1228.78</td><td>0.423424</td></tr><tr><th>17</th><td>154.372</td><td>7.64322</td><td>-1219.6</td><td>-1228.13</td><td>0.811692</td></tr><tr><th>18</th><td>154.673</td><td>7.69347</td><td>-1219.43</td><td>-1227.94</td><td>0.982838</td></tr><tr><th>19</th><td>154.472</td><td>7.29146</td><td>-1220.71</td><td>-1229.23</td><td>0.269506</td></tr><tr><th>20</th><td>153.97</td><td>7.79397</td><td>-1220.57</td><td>-1229.12</td><td>0.302447</td></tr><tr><th>21</th><td>155.075</td><td>7.94472</td><td>-1220.3</td><td>-1228.78</td><td>0.422147</td></tr><tr><th>22</th><td>154.271</td><td>7.86935</td><td>-1219.82</td><td>-1228.35</td><td>0.653362</td></tr><tr><th>23</th><td>155.075</td><td>8.37186</td><td>-1222.1</td><td>-1230.58</td><td>0.0700182</td></tr><tr><th>24</th><td>154.472</td><td>7.46734</td><td>-1219.89</td><td>-1228.41</td><td>0.614306</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.19-1" href="#Snippet-4.19-1">Snippet 4.19</a></h3><p>Density of mu</p><div><pre><code class="language-julia">density(samples[:mu])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip2200">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2200)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2201">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2200)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2202">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  216.486,1937.01 216.486,47.2441 
  "/>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  689.417,1937.01 689.417,47.2441 
  "/>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1162.35,1937.01 1162.35,47.2441 
  "/>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1635.28,1937.01 1635.28,47.2441 
  "/>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1434.04 1921.26,1434.04 
  "/>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,984.547 1921.26,984.547 
  "/>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,535.059 1921.26,535.059 
  "/>
<polyline clip-path="url(#clip2202)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,85.5699 1921.26,85.5699 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  216.486,1937.01 216.486,1908.66 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  689.417,1937.01 689.417,1908.66 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1162.35,1937.01 1162.35,1908.66 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1635.28,1937.01 1635.28,1908.66 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1434.04 121.89,1434.04 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,984.547 121.89,984.547 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,535.059 121.89,535.059 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,85.5699 121.89,85.5699 
  "/>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 216.486, 1989.01)" x="216.486" y="1989.01">153</text>
</g>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 689.417, 1989.01)" x="689.417" y="1989.01">154</text>
</g>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1162.35, 1989.01)" x="1162.35" y="1989.01">155</text>
</g>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1635.28, 1989.01)" x="1635.28" y="1989.01">156</text>
</g>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.00</text>
</g>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1451.54)" x="74.4882" y="1451.54">0.25</text>
</g>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1002.05)" x="74.4882" y="1002.05">0.50</text>
</g>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 552.559)" x="74.4882" y="552.559">0.75</text>
</g>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 103.07)" x="74.4882" y="103.07">1.00</text>
</g>
<polyline clip-path="url(#clip2202)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.51 180.83,1883.48 189.49,1883.42 198.15,1883.32 206.81,1883.15 215.47,1882.92 224.131,1882.65 
  232.791,1882.4 241.451,1882.23 250.111,1882.2 258.771,1882.29 267.431,1882.46 276.091,1882.58 284.752,1882.54 293.412,1882.19 302.072,1881.45 310.732,1880.3 
  319.392,1878.86 328.052,1877.31 336.713,1875.86 345.373,1874.61 354.033,1873.49 362.693,1872.34 371.353,1871.04 380.013,1869.55 388.673,1867.86 397.334,1865.87 
  405.994,1863.34 414.654,1860.04 423.314,1855.79 431.974,1850.41 440.634,1843.51 449.294,1834.59 457.955,1823.5 466.615,1810.89 475.275,1798.2 483.935,1786.71 
  492.595,1776.55 501.255,1766.64 509.915,1755.74 518.576,1743.58 527.236,1730.87 535.896,1718.03 544.556,1704.23 553.216,1688.04 561.876,1669.16 570.537,1649.27 
  579.197,1630.62 587.857,1613.65 596.517,1596.31 605.177,1576.28 613.837,1553.55 622.497,1530.52 631.158,1509.03 639.818,1487.73 648.478,1463.06 657.138,1433.15 
  665.798,1400.04 674.458,1367.33 683.118,1335.58 691.779,1301.03 700.439,1259.67 709.099,1212.33 717.759,1164.37 726.419,1119.69 735.079,1075.74 743.739,1026.26 
  752.4,969.64 761.06,913.635 769.72,869.727 778.38,842.201 787.04,823.491 795.7,801.26 804.361,769.615 813.021,732.074 821.681,693.486 830.341,651.323 
  839.001,597.825 847.661,531.424 856.321,463.637 864.982,411.414 873.642,381.537 882.302,364.024 890.962,342.477 899.622,310.396 908.282,275.447 916.942,247.402 
  925.603,224.596 934.263,195.706 942.923,155.611 951.583,116.672 960.243,100.728 968.903,118.824 977.563,160.25 986.224,202.815 994.884,233.036 1003.54,254.658 
  1012.2,278.011 1020.86,304.368 1029.52,323.906 1038.18,328.755 1046.84,324.583 1055.5,326.221 1064.16,342.046 1072.83,365.409 1081.49,383.3 1090.15,392.382 
  1098.81,403.931 1107.47,432.083 1116.13,478.783 1124.79,532.276 1133.45,580.359 1142.11,623.187 1150.77,671.694 1159.43,734.234 1168.09,806.667 1176.75,876.137 
  1185.41,933.127 1194.07,978.223 1202.73,1017.54 1211.39,1053.96 1220.05,1084.9 1228.71,1108.42 1237.37,1129.25 1246.03,1156.95 1254.69,1197.62 1263.35,1248.34 
  1272.01,1300.09 1280.67,1345.64 1289.33,1384.35 1297.99,1419.75 1306.65,1454.05 1315.31,1485.91 1323.97,1513.11 1332.63,1536.18 1341.29,1558.45 1349.95,1582.77 
  1358.61,1608.78 1367.27,1633.75 1375.93,1655.69 1384.59,1675.2 1393.25,1694.4 1401.91,1714.45 1410.57,1734.33 1419.23,1751.96 1427.89,1765.97 1436.55,1776.37 
  1445.21,1783.84 1453.87,1788.96 1462.53,1792.28 1471.19,1794.89 1479.85,1798.52 1488.51,1804.73 1497.17,1813.8 1505.83,1824.57 1514.49,1835.21 1523.15,1844.29 
  1531.81,1851.34 1540.47,1856.55 1549.13,1860.37 1557.79,1863.15 1566.45,1865.22 1575.11,1866.96 1583.77,1868.71 1592.43,1870.62 1601.09,1872.6 1609.75,1874.45 
  1618.41,1876.03 1627.07,1877.32 1635.73,1878.4 1644.39,1879.33 1653.06,1880.13 1661.72,1880.79 1670.38,1881.33 1679.04,1881.78 1687.7,1882.18 1696.36,1882.53 
  1705.02,1882.82 1713.68,1883 1722.34,1883.05 1731,1882.96 1739.66,1882.77 1748.32,1882.53 1756.98,1882.32 1765.64,1882.21 1774.3,1882.24 1782.96,1882.4 
  1791.62,1882.65 1800.28,1882.92 1808.94,1883.15 1817.6,1883.32 1826.26,1883.42 1834.92,1883.48 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip2200)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip2200)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip2200)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip2200)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><p>Density of sigma</p><div><pre><code class="language-julia">density(samples[:sigma])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip2300">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2300)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2301">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2300)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2302">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  427.789,1937.01 427.789,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  776.541,1937.01 776.541,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1125.29,1937.01 1125.29,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1474.05,1937.01 1474.05,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1822.8,1937.01 1822.8,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1564.86 1921.26,1564.86 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1246.2 1921.26,1246.2 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,927.537 1921.26,927.537 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,608.875 1921.26,608.875 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,290.212 1921.26,290.212 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  427.789,1937.01 427.789,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  776.541,1937.01 776.541,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1125.29,1937.01 1125.29,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1474.05,1937.01 1474.05,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1822.8,1937.01 1822.8,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1564.86 121.89,1564.86 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1246.2 121.89,1246.2 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,927.537 121.89,927.537 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,608.875 121.89,608.875 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,290.212 121.89,290.212 
  "/>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 427.789, 1989.01)" x="427.789" y="1989.01">7.0</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 776.541, 1989.01)" x="776.541" y="1989.01">7.5</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1125.29, 1989.01)" x="1125.29" y="1989.01">8.0</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1474.05, 1989.01)" x="1474.05" y="1989.01">8.5</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1822.8, 1989.01)" x="1822.8" y="1989.01">9.0</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.00</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1582.36)" x="74.4882" y="1582.36">0.25</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1263.7)" x="74.4882" y="1263.7">0.50</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 945.037)" x="74.4882" y="945.037">0.75</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 626.375)" x="74.4882" y="626.375">1.00</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 307.712)" x="74.4882" y="307.712">1.25</text>
</g>
<polyline clip-path="url(#clip2302)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.5 180.83,1883.47 189.49,1883.42 198.15,1883.31 206.81,1883.13 215.47,1882.87 224.131,1882.52 
  232.791,1882.1 241.451,1881.68 250.111,1881.33 258.771,1881.13 267.431,1881.1 276.091,1881.23 284.752,1881.45 293.412,1881.63 302.072,1881.65 310.732,1881.37 
  319.392,1880.71 328.052,1879.57 336.713,1877.93 345.373,1875.74 354.033,1873.01 362.693,1869.8 371.353,1866.23 380.013,1862.46 388.673,1858.7 397.334,1855.1 
  405.994,1851.69 414.654,1848.36 423.314,1844.82 431.974,1840.75 440.634,1835.85 449.294,1830.01 457.955,1823.34 466.615,1816.06 475.275,1808.4 483.935,1800.38 
  492.595,1791.69 501.255,1781.76 509.915,1769.91 518.576,1755.55 527.236,1738.32 535.896,1718.16 544.556,1695.25 553.216,1669.94 561.876,1642.76 570.537,1614.41 
  579.197,1585.67 587.857,1557.26 596.517,1529.62 605.177,1502.75 613.837,1476.18 622.497,1449.07 631.158,1420.49 639.818,1389.67 648.478,1356.1 657.138,1319.52 
  665.798,1279.83 674.458,1237.01 683.118,1191.16 691.779,1142.58 700.439,1091.77 709.099,1039.45 717.759,986.508 726.419,933.962 735.079,882.946 743.739,834.597 
  752.4,789.838 761.06,749.103 769.72,712.118 778.38,677.861 787.04,644.735 795.7,610.93 804.361,574.848 813.021,535.512 821.681,492.804 830.341,447.478 
  839.001,400.893 847.661,354.564 856.321,309.724 864.982,267.118 873.642,227.166 882.302,190.384 890.962,157.8 899.622,131.043 908.282,111.946 916.942,101.815 
  925.603,100.728 934.263,107.289 942.923,119.008 951.583,133.192 960.243,147.905 968.903,162.554 977.563,177.811 986.224,194.978 994.884,215.167 1003.54,238.752 
  1012.2,265.312 1020.86,293.986 1029.52,323.927 1038.18,354.567 1046.84,385.613 1055.5,416.889 1064.16,448.225 1072.83,479.499 1081.49,510.763 1090.15,542.328 
  1098.81,574.706 1107.47,608.422 1116.13,643.833 1124.79,681.057 1133.45,720.029 1142.11,760.581 1150.77,802.467 1159.43,845.3 1168.09,888.503 1176.75,931.388 
  1185.41,973.368 1194.07,1014.16 1202.73,1053.86 1211.39,1092.73 1220.05,1131 1228.71,1168.61 1237.37,1205.31 1246.03,1240.82 1254.69,1275.08 1263.35,1308.28 
  1272.01,1340.73 1280.67,1372.66 1289.33,1404.09 1297.99,1434.79 1306.65,1464.41 1315.31,1492.54 1323.97,1518.84 1332.63,1543.07 1341.29,1565.12 1349.95,1585.05 
  1358.61,1603.11 1367.27,1619.73 1375.93,1635.43 1384.59,1650.73 1393.25,1666.03 1401.91,1681.52 1410.57,1697.2 1419.23,1712.88 1427.89,1728.17 1436.55,1742.62 
  1445.21,1755.74 1453.87,1767.09 1462.53,1776.45 1471.19,1783.79 1479.85,1789.36 1488.51,1793.6 1497.17,1797.09 1505.83,1800.37 1514.49,1803.86 1523.15,1807.8 
  1531.81,1812.21 1540.47,1816.96 1549.13,1821.89 1557.79,1826.88 1566.45,1831.84 1575.11,1836.72 1583.77,1841.46 1592.43,1845.97 1601.09,1850.18 1609.75,1854 
  1618.41,1857.41 1627.07,1860.43 1635.73,1863.12 1644.39,1865.53 1653.06,1867.71 1661.72,1869.68 1670.38,1871.49 1679.04,1873.13 1687.7,1874.63 1696.36,1875.98 
  1705.02,1877.15 1713.68,1878.14 1722.34,1878.94 1731,1879.58 1739.66,1880.11 1748.32,1880.59 1756.98,1881.07 1765.64,1881.55 1774.3,1882.02 1782.96,1882.45 
  1791.62,1882.81 1800.28,1883.09 1808.94,1883.27 1817.6,1883.39 1826.26,1883.46 1834.92,1883.5 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip2300)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><h3><a class="nav-anchor" id="Snippet-4.20-1" href="#Snippet-4.20-1">Snippet 4.20</a></h3><p>Hdp mu</p><div><pre><code class="language-julia">MCMCChains.hpd(samples[:mu])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 153.76884422110552
 155.37688442211055</code></pre></div><p>Hdp sigma</p><div><pre><code class="language-julia">MCMCChains.hpd(samples[:sigma])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 7.21608040201005
 8.346733668341708</code></pre></div><p>End of <code>clip-14-20.jl</code></p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../clip-07-13s/"><span class="direction">Previous</span><span class="title">clip-07-13s</span></a><a class="next" href="../clip-21-23/"><span class="direction">Next</span><span class="title">clip-21-23</span></a></footer></article></body></html>
