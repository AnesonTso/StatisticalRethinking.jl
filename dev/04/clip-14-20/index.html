<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>clip-14-20 · StatisticalRethinking.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>StatisticalRethinking.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><a class="toctext" href="../../layout/">Layout</a></li><li><a class="toctext" href="../../acknowledgements/">Acknowledgements</a></li><li><a class="toctext" href="../../references/">References</a></li><li><span class="toctext">Chapter 00</span><ul><li><a class="toctext" href="../../00/clip-01-03/">clip-01-03</a></li><li><a class="toctext" href="../../00/clip-04-05/">clip-04-05</a></li></ul></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/clip-01-02/">clip-01-02</a></li><li><a class="toctext" href="../../02/clip-03-05/">clip-03-05</a></li><li><a class="toctext" href="../../02/clip-06-07/">clip-06-07</a></li><li><a class="toctext" href="../../02/clip-08s/">clip-08s</a></li><li><a class="toctext" href="../../02/clip-08t/">clip-08t</a></li></ul></li><li><span class="toctext">Chapter 03</span><ul><li><a class="toctext" href="../../03/clip-01/">clip-01</a></li><li><a class="toctext" href="../../03/clip-02-05/">clip-02-05</a></li><li><a class="toctext" href="../../03/clip-05s/">clip-05s</a></li><li><a class="toctext" href="../../03/clip-06-16s/">clip-06-16s</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../m4.1s/">m4.1s</a></li><li><a class="toctext" href="../m4.2s/">m4.2s</a></li><li><a class="toctext" href="../m4.2t/">m4.2t</a></li><li><a class="toctext" href="../m4.3s/">m4.3s</a></li><li><a class="toctext" href="../m4.4s/">m4.4s</a></li><li><a class="toctext" href="../m4.5s/">m4.5s</a></li><li><a class="toctext" href="../m4.5d/">m4.5d</a></li><li><a class="toctext" href="../clip-01-06/">clip-01-06</a></li><li><a class="toctext" href="../clip-07-13s/">clip-07-13s</a></li><li class="current"><a class="toctext" href>clip-14-20</a><ul class="internal"></ul></li><li><a class="toctext" href="../clip-21-23/">clip-21-23</a></li><li><a class="toctext" href="../clip-24-29s/">clip-24-29s</a></li><li><a class="toctext" href="../clip-30s/">clip-30s</a></li><li><a class="toctext" href="../clip-38s/">clip-38s</a></li><li><a class="toctext" href="../clip-43s/">clip-43s</a></li><li><a class="toctext" href="../clip-45-47s/">clip-45-47s</a></li><li><a class="toctext" href="../clip-48-54s/">clip-48-54s</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/clip-01s/">clip-01s</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1/">m8.1</a></li><li><a class="toctext" href="../../08/m8.3/">m8.3</a></li></ul></li><li><span class="toctext">Chapter 10</span></li><li><span class="toctext">Chapter 11</span></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../../12/m12.6.1s/">m12.6.1s</a></li><li><a class="toctext" href="../../12/m12.6.2s/">m12.6.2s</a></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 04</li><li><a href>clip-14-20</a></li></ul><a class="edit-page" href="https://github.com/StanJulia/StatisticalRethinking.jl/blob/master/scripts/04/clip-14-20.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>clip-14-20</span><a class="fa fa-bars" href="#"></a></div></header><p>Load Julia packages (libraries) needed  for the snippets in chapter 0</p><div><pre><code class="language-julia">using StatisticalRethinking, CmdStan, StanMCMCChain
gr(size=(500,500));</code></pre></div><p>CmdStan uses a tmp directory to store the output of cmdstan</p><div><pre><code class="language-julia">ProjDir = rel_path(&quot;..&quot;, &quot;scripts&quot;, &quot;04&quot;)
cd(ProjDir)</code></pre></div><h3><a class="nav-anchor" id="snippet-4.7-1" href="#snippet-4.7-1">snippet 4.7</a></h3><div><pre><code class="language-julia">howell1 = CSV.read(rel_path(&quot;..&quot;, &quot;data&quot;, &quot;Howell1.csv&quot;), delim=&#39;;&#39;)
df = convert(DataFrame, howell1);</code></pre></div><h3><a class="nav-anchor" id="snippet-4.8-1" href="#snippet-4.8-1">snippet 4.8</a></h3><p>Use only adults</p><div><pre><code class="language-julia">df2 = filter(row -&gt; row[:age] &gt;= 18, df);</code></pre></div><p>Show first 5 rows of DataFrame df</p><div><pre><code class="language-julia">first(df2, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>5 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.14-1" href="#Snippet-4.14-1">Snippet 4.14</a></h3><p>Generate approximate probabilities</p><div><pre><code class="language-julia">struct Post
  mu::Float64
  sigma::Float64
  ll:: Float64
  prod::Float64
  prob::Float64
end

mu_list = repeat(range(140, 160, length=200), 200);
sigma_list = repeat(range(4, 9, length=200), inner=200);

ll = zeros(40000);
for i in 1:40000
    d1 = Normal(mu_list[i], sigma_list[i])
    ll[i] = sum(log.(pdf.(d1, df2[:height])))
end

d2 = Normal(178.0, 20.0)
d3 = Uniform(0, 50)
prod = ll + log.(pdf.(d2, mu_list)) + log.(pdf.(d3, sigma_list))
prob = exp.(prod .- maximum(prod))
post = DataFrame(mu=mu_list, sigma=sigma_list, ll=ll, prod=prod, prob=prob)
first(post, 10)</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10 rows × 5 columns</p><tr><th>1</th><td>140.0</td><td>4.0</td><td>-3812.78</td><td>-3822.41</td><td>0.0</td></tr><tr><th>2</th><td>140.101</td><td>4.0</td><td>-3780.61</td><td>-3790.23</td><td>0.0</td></tr><tr><th>3</th><td>140.201</td><td>4.0</td><td>-3748.67</td><td>-3758.28</td><td>0.0</td></tr><tr><th>4</th><td>140.302</td><td>4.0</td><td>-3716.95</td><td>-3726.55</td><td>0.0</td></tr><tr><th>5</th><td>140.402</td><td>4.0</td><td>-3685.45</td><td>-3695.05</td><td>0.0</td></tr><tr><th>6</th><td>140.503</td><td>4.0</td><td>-3654.18</td><td>-3663.76</td><td>0.0</td></tr><tr><th>7</th><td>140.603</td><td>4.0</td><td>-3623.13</td><td>-3632.7</td><td>0.0</td></tr><tr><th>8</th><td>140.704</td><td>4.0</td><td>-3592.3</td><td>-3601.86</td><td>0.0</td></tr><tr><th>9</th><td>140.804</td><td>4.0</td><td>-3561.69</td><td>-3571.24</td><td>0.0</td></tr><tr><th>10</th><td>140.905</td><td>4.0</td><td>-3531.3</td><td>-3540.85</td><td>0.0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.15-1" href="#Snippet-4.15-1">Snippet 4.15</a></h3><p>Sample post</p><div><pre><code class="language-julia">samples = post[sample(1:size(post, 1), Weights(post[:prob]), 10000, replace=true), :]</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10,000 rows × 5 columns</p><tr><th>1</th><td>154.673</td><td>7.39196</td><td>-1220.15</td><td>-1228.66</td><td>0.476545</td></tr><tr><th>2</th><td>154.673</td><td>8.09548</td><td>-1220.14</td><td>-1228.65</td><td>0.481712</td></tr><tr><th>3</th><td>154.874</td><td>7.51759</td><td>-1219.93</td><td>-1228.42</td><td>0.60582</td></tr><tr><th>4</th><td>154.472</td><td>7.61809</td><td>-1219.53</td><td>-1228.05</td><td>0.879989</td></tr><tr><th>5</th><td>154.472</td><td>8.09548</td><td>-1220.17</td><td>-1228.69</td><td>0.463784</td></tr><tr><th>6</th><td>154.271</td><td>7.96985</td><td>-1220.02</td><td>-1228.55</td><td>0.533847</td></tr><tr><th>7</th><td>154.774</td><td>8.04523</td><td>-1220.03</td><td>-1228.53</td><td>0.541365</td></tr><tr><th>8</th><td>154.975</td><td>7.94472</td><td>-1220.06</td><td>-1228.55</td><td>0.533515</td></tr><tr><th>9</th><td>155.075</td><td>7.54271</td><td>-1220.33</td><td>-1228.81</td><td>0.408921</td></tr><tr><th>10</th><td>153.97</td><td>7.39196</td><td>-1221.4</td><td>-1229.95</td><td>0.131157</td></tr><tr><th>11</th><td>154.673</td><td>7.76884</td><td>-1219.43</td><td>-1227.94</td><td>0.983449</td></tr><tr><th>12</th><td>154.372</td><td>7.61809</td><td>-1219.64</td><td>-1228.16</td><td>0.786286</td></tr><tr><th>13</th><td>154.372</td><td>7.69347</td><td>-1219.56</td><td>-1228.09</td><td>0.844885</td></tr><tr><th>14</th><td>154.774</td><td>7.26633</td><td>-1220.92</td><td>-1229.42</td><td>0.222694</td></tr><tr><th>15</th><td>154.372</td><td>7.34171</td><td>-1220.55</td><td>-1229.07</td><td>0.31685</td></tr><tr><th>16</th><td>153.668</td><td>7.94472</td><td>-1222.07</td><td>-1230.63</td><td>0.0663464</td></tr><tr><th>17</th><td>154.171</td><td>7.99497</td><td>-1220.29</td><td>-1228.83</td><td>0.40314</td></tr><tr><th>18</th><td>154.07</td><td>7.9196</td><td>-1220.38</td><td>-1228.93</td><td>0.365593</td></tr><tr><th>19</th><td>154.271</td><td>7.84422</td><td>-1219.78</td><td>-1228.31</td><td>0.675771</td></tr><tr><th>20</th><td>154.271</td><td>7.39196</td><td>-1220.48</td><td>-1229.01</td><td>0.336936</td></tr><tr><th>21</th><td>155.377</td><td>8.09548</td><td>-1221.76</td><td>-1230.23</td><td>0.0995225</td></tr><tr><th>22</th><td>154.372</td><td>7.79397</td><td>-1219.57</td><td>-1228.1</td><td>0.836123</td></tr><tr><th>23</th><td>154.975</td><td>7.79397</td><td>-1219.84</td><td>-1228.33</td><td>0.663428</td></tr><tr><th>24</th><td>154.673</td><td>7.99497</td><td>-1219.81</td><td>-1228.32</td><td>0.673934</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.19-1" href="#Snippet-4.19-1">Snippet 4.19</a></h3><p>Density of mu</p><div><pre><code class="language-julia">density(samples[:mu])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip6400">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6400)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6401">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6400)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6402">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  218.479,1937.01 218.479,47.2441 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  704.825,1937.01 704.825,47.2441 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1191.17,1937.01 1191.17,47.2441 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1677.52,1937.01 1677.52,47.2441 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1431.41 1921.26,1431.41 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,979.296 1921.26,979.296 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,527.182 1921.26,527.182 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,75.0679 1921.26,75.0679 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  218.479,1937.01 218.479,1908.66 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  704.825,1937.01 704.825,1908.66 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1191.17,1937.01 1191.17,1908.66 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1677.52,1937.01 1677.52,1908.66 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1431.41 121.89,1431.41 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,979.296 121.89,979.296 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,527.182 121.89,527.182 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,75.0679 121.89,75.0679 
  "/>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 218.479, 1989.01)" x="218.479" y="1989.01">153</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 704.825, 1989.01)" x="704.825" y="1989.01">154</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1191.17, 1989.01)" x="1191.17" y="1989.01">155</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1677.52, 1989.01)" x="1677.52" y="1989.01">156</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.00</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1448.91)" x="74.4882" y="1448.91">0.25</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 996.796)" x="74.4882" y="996.796">0.50</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 544.682)" x="74.4882" y="544.682">0.75</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 92.5679)" x="74.4882" y="92.5679">1.00</text>
</g>
<polyline clip-path="url(#clip6402)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.51 180.83,1883.49 189.49,1883.44 198.15,1883.34 206.81,1883.18 215.47,1882.95 224.131,1882.66 
  232.791,1882.34 241.451,1882.01 250.111,1881.7 258.771,1881.41 267.431,1881.1 276.091,1880.76 284.752,1880.37 293.412,1879.96 302.072,1879.5 310.732,1878.98 
  319.392,1878.32 328.052,1877.46 336.713,1876.37 345.373,1874.95 354.033,1873.09 362.693,1870.67 371.353,1867.74 380.013,1864.55 388.673,1861.54 397.334,1859.04 
  405.994,1857.06 414.654,1855.29 423.314,1853.33 431.974,1850.95 440.634,1848.07 449.294,1844.63 457.955,1840.36 466.615,1834.92 475.275,1828.18 483.935,1820.3 
  492.595,1811.31 501.255,1800.82 509.915,1788.07 518.576,1772.77 527.236,1755.77 535.896,1738.84 544.556,1723.33 553.216,1709.04 561.876,1694.43 570.537,1678.2 
  579.197,1660.66 587.857,1643.4 596.517,1627.36 605.177,1611.47 613.837,1593.5 622.497,1572.4 631.158,1549.52 639.818,1527.14 648.478,1505.55 657.138,1482.16 
  665.798,1453.8 674.458,1420.14 683.118,1384.22 691.779,1349.17 700.439,1314.56 709.099,1276.63 717.759,1232.83 726.419,1185.7 735.079,1141.31 743.739,1103.23 
  752.4,1068.38 761.06,1029.82 769.72,984.196 778.38,935.768 787.04,892.166 795.7,855.828 804.361,820.586 813.021,777.793 821.681,725.87 830.341,672.765 
  839.001,628.047 847.661,592.861 856.321,558.911 864.982,518.001 873.642,471.743 882.302,430.287 890.962,400.88 899.622,378.854 908.282,351.662 916.942,312.343 
  925.603,267.749 934.263,231.862 942.923,210.888 951.583,196.417 960.243,174.727 968.903,142.613 977.563,112.48 986.224,100.728 994.884,111.505 1003.54,132.966 
  1012.2,149.616 1020.86,157.051 1029.52,163.355 1038.18,176.666 1046.84,193.832 1055.5,203.551 1064.16,200.773 1072.83,195.955 1081.49,207.918 1090.15,246.862 
  1098.81,305.016 1107.47,364.458 1116.13,413.684 1124.79,456.015 1133.45,502.451 1142.11,558.087 1150.77,616.793 1159.43,668.618 1168.09,710.48 1176.75,748.226 
  1185.41,788.662 1194.07,831.352 1202.73,869.511 1211.39,898.657 1220.05,923.028 1228.71,952.494 1237.37,993.288 1246.03,1042.37 1254.69,1091.06 1263.35,1133.57 
  1272.01,1171.62 1280.67,1210.99 1289.33,1254.6 1297.99,1299.54 1306.65,1340.51 1315.31,1375.06 1323.97,1405.15 1332.63,1433.92 1341.29,1461.94 1349.95,1487.12 
  1358.61,1508.07 1367.27,1526.65 1375.93,1546.98 1384.59,1571.91 1393.25,1600.57 1401.91,1629.48 1410.57,1655.64 1419.23,1678.64 1427.89,1699.96 1436.55,1720.86 
  1445.21,1741.05 1453.87,1759.18 1462.53,1774.29 1471.19,1786.51 1479.85,1796.62 1488.51,1805.17 1497.17,1812.26 1505.83,1818 1514.49,1822.95 1523.15,1828 
  1531.81,1833.76 1540.47,1840.1 1549.13,1846.35 1557.79,1851.77 1566.45,1855.99 1575.11,1859.02 1583.77,1861.07 1592.43,1862.33 1601.09,1863.04 1609.75,1863.51 
  1618.41,1864.12 1627.07,1865.07 1635.73,1866.35 1644.39,1867.74 1653.06,1869.1 1661.72,1870.41 1670.38,1871.83 1679.04,1873.48 1687.7,1875.31 1696.36,1877.14 
  1705.02,1878.73 1713.68,1879.96 1722.34,1880.79 1731,1881.3 1739.66,1881.57 1748.32,1881.71 1756.98,1881.81 1765.64,1881.93 1774.3,1882.13 1782.96,1882.39 
  1791.62,1882.69 1800.28,1882.96 1808.94,1883.19 1817.6,1883.34 1826.26,1883.44 1834.92,1883.49 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip6400)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><p>Density of sigma</p><div><pre><code class="language-julia">density(samples[:sigma])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip6500">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6500)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6501">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6500)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6502">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  166.362,1937.01 166.362,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  485.335,1937.01 485.335,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  804.308,1937.01 804.308,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1123.28,1937.01 1123.28,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1442.25,1937.01 1442.25,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1761.23,1937.01 1761.23,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1558.35 1921.26,1558.35 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1233.17 1921.26,1233.17 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,907.991 1921.26,907.991 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,582.813 1921.26,582.813 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,257.635 1921.26,257.635 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  166.362,1937.01 166.362,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  485.335,1937.01 485.335,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  804.308,1937.01 804.308,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1123.28,1937.01 1123.28,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1442.25,1937.01 1442.25,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1761.23,1937.01 1761.23,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1558.35 121.89,1558.35 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1233.17 121.89,1233.17 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,907.991 121.89,907.991 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,582.813 121.89,582.813 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,257.635 121.89,257.635 
  "/>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 166.362, 1989.01)" x="166.362" y="1989.01">6.5</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 485.335, 1989.01)" x="485.335" y="1989.01">7.0</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 804.308, 1989.01)" x="804.308" y="1989.01">7.5</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1123.28, 1989.01)" x="1123.28" y="1989.01">8.0</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1442.25, 1989.01)" x="1442.25" y="1989.01">8.5</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1761.23, 1989.01)" x="1761.23" y="1989.01">9.0</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.00</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1575.85)" x="74.4882" y="1575.85">0.25</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1250.67)" x="74.4882" y="1250.67">0.50</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 925.491)" x="74.4882" y="925.491">0.75</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 600.313)" x="74.4882" y="600.313">1.00</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 275.135)" x="74.4882" y="275.135">1.25</text>
</g>
<polyline clip-path="url(#clip6502)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.51 180.83,1883.49 189.49,1883.45 198.15,1883.38 206.81,1883.26 215.47,1883.09 224.131,1882.87 
  232.791,1882.63 241.451,1882.43 250.111,1882.28 258.771,1882.22 267.431,1882.24 276.091,1882.28 284.752,1882.31 293.412,1882.29 302.072,1882.24 310.732,1882.2 
  319.392,1882.2 328.052,1882.25 336.713,1882.32 345.373,1882.33 354.033,1882.18 362.693,1881.77 371.353,1881.04 380.013,1879.96 388.673,1878.52 397.334,1876.76 
  405.994,1874.67 414.654,1872.29 423.314,1869.66 431.974,1866.85 440.634,1863.93 449.294,1860.98 457.955,1857.99 466.615,1854.87 475.275,1851.45 483.935,1847.54 
  492.595,1842.9 501.255,1837.31 509.915,1830.52 518.576,1822.27 527.236,1812.2 535.896,1799.95 544.556,1785.17 553.216,1767.64 561.876,1747.3 570.537,1724.26 
  579.197,1698.72 587.857,1670.97 596.517,1641.36 605.177,1610.44 613.837,1578.98 622.497,1547.96 631.158,1518.27 639.818,1490.37 648.478,1464.04 657.138,1438.35 
  665.798,1411.85 674.458,1382.99 683.118,1350.49 691.779,1313.63 700.439,1272.39 709.099,1227.42 717.759,1179.75 726.419,1130.49 735.079,1080.48 743.739,1030.16 
  752.4,979.683 761.06,929.078 769.72,878.387 778.38,827.693 787.04,777.136 795.7,726.965 804.361,677.621 813.021,629.752 821.681,584.149 830.341,541.578 
  839.001,502.598 847.661,467.412 856.321,435.836 864.982,407.377 873.642,381.343 882.302,356.825 890.962,332.58 899.622,307.018 908.282,278.57 916.942,246.449 
  925.603,211.413 934.263,175.997 942.923,143.958 951.583,119.148 960.243,104.379 968.903,100.728 977.563,107.462 986.224,122.41 994.884,142.543 1003.54,164.58 
  1012.2,185.602 1020.86,203.671 1029.52,218.377 1038.18,231.136 1046.84,244.968 1055.5,263.667 1064.16,290.596 1072.83,327.594 1081.49,374.506 1090.15,429.518 
  1098.81,490.025 1107.47,553.451 1116.13,617.588 1124.79,680.448 1133.45,739.994 1142.11,794.21 1150.77,841.636 1159.43,882.067 1168.09,916.92 1176.75,948.969 
  1185.41,981.5 1194.07,1017.28 1202.73,1057.78 1211.39,1102.89 1220.05,1151.11 1228.71,1200.11 1237.37,1247.47 1246.03,1291.23 1254.69,1330.37 1263.35,1364.9 
  1272.01,1395.67 1280.67,1424.03 1289.33,1451.29 1297.99,1478.33 1306.65,1505.43 1315.31,1532.28 1323.97,1558.29 1332.63,1582.83 1341.29,1605.44 1349.95,1625.87 
  1358.61,1643.99 1367.27,1659.85 1375.93,1673.72 1384.59,1686.06 1393.25,1697.48 1401.91,1708.52 1410.57,1719.51 1419.23,1730.5 1427.89,1741.31 1436.55,1751.73 
  1445.21,1761.58 1453.87,1770.83 1462.53,1779.64 1471.19,1788.31 1479.85,1797.2 1488.51,1806.49 1497.17,1816.1 1505.83,1825.52 1514.49,1834.04 1523.15,1840.95 
  1531.81,1845.89 1540.47,1848.98 1549.13,1850.78 1557.79,1852.05 1566.45,1853.51 1575.11,1855.6 1583.77,1858.43 1592.43,1861.82 1601.09,1865.39 1609.75,1868.74 
  1618.41,1871.57 1627.07,1873.74 1635.73,1875.27 1644.39,1876.31 1653.06,1877.01 1661.72,1877.51 1670.38,1877.87 1679.04,1878.16 1687.7,1878.4 1696.36,1878.66 
  1705.02,1878.97 1713.68,1879.33 1722.34,1879.7 1731,1880.01 1739.66,1880.24 1748.32,1880.41 1756.98,1880.59 1765.64,1880.85 1774.3,1881.23 1782.96,1881.7 
  1791.62,1882.19 1800.28,1882.64 1808.94,1882.99 1817.6,1883.23 1826.26,1883.38 1834.92,1883.46 1843.58,1883.5 1852.24,1883.51 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip6500)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><h3><a class="nav-anchor" id="Snippet-4.20-1" href="#Snippet-4.20-1">Snippet 4.20</a></h3><p>Hdp mu</p><div><pre><code class="language-julia">MCMCChain.hpd(samples[:mu])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 153.66834170854273
 155.27638190954775</code></pre></div><p>Hdp sigma</p><div><pre><code class="language-julia">MCMCChain.hpd(samples[:sigma])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 7.190954773869347
 8.346733668341708</code></pre></div><p>End of <code>clip-14-20.jl</code></p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../clip-07-13s/"><span class="direction">Previous</span><span class="title">clip-07-13s</span></a><a class="next" href="../clip-21-23/"><span class="direction">Next</span><span class="title">clip-21-23</span></a></footer></article></body></html>
