<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>clip-14-20 · StatisticalRethinking.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>StatisticalRethinking.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><a class="toctext" href="../../layout/">Layout</a></li><li><a class="toctext" href="../../versions/">Versions</a></li><li><a class="toctext" href="../../acknowledgements/">Acknowledgements</a></li><li><a class="toctext" href="../../references/">References</a></li><li><span class="toctext">Chapter 00</span><ul><li><a class="toctext" href="../../00/clip-01-03/">clip-01-03</a></li><li><a class="toctext" href="../../00/clip-04-05/">clip-04-05</a></li></ul></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/clip-01-02/">clip-01-02</a></li><li><a class="toctext" href="../../02/clip-03-05/">clip-03-05</a></li><li><a class="toctext" href="../../02/clip-06-07/">clip-06-07</a></li><li><a class="toctext" href="../../02/m2.1s/">m2.1s</a></li></ul></li><li><span class="toctext">Chapter 03</span><ul><li><a class="toctext" href="../../03/clip-01/">clip-01</a></li><li><a class="toctext" href="../../03/clip-02-05/">clip-02-05</a></li><li><a class="toctext" href="../../03/clip-05s/">clip-05s</a></li><li><a class="toctext" href="../../03/clip-06-16s/">clip-06-16s</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../m4.1s/">m4.1s</a></li><li><a class="toctext" href="../clip-01-06/">clip-01-06</a></li><li><a class="toctext" href="../clip-07-13s/">clip-07-13s</a></li><li class="current"><a class="toctext" href>clip-14-20</a><ul class="internal"></ul></li><li><a class="toctext" href="../clip-21-23/">clip-21-23</a></li><li><a class="toctext" href="../clip-24-29s/">clip-24-29s</a></li><li><a class="toctext" href="../clip-30s/">clip-30s</a></li><li><a class="toctext" href="../clip-38s/">clip-38s</a></li><li><a class="toctext" href="../clip-43s/">clip-43s</a></li><li><a class="toctext" href="../clip-45-47s/">clip-45-47s</a></li><li><a class="toctext" href="../clip-48-54s/">clip-48-54s</a></li><li><a class="toctext" href="../m4.2s/">m4.2s</a></li><li><a class="toctext" href="../m4.3s/">m4.3s</a></li><li><a class="toctext" href="../m4.4s/">m4.4s</a></li><li><a class="toctext" href="../m4.5s/">m4.5s</a></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 04</li><li><a href>clip-14-20</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/StatisticalRethinking.jl/blob/master/scripts/04/clip-14-20.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>clip-14-20</span><a class="fa fa-bars" href="#"></a></div></header><p>Load Julia packages (libraries) needed  for the snippets in chapter 0</p><div><pre><code class="language-julia">using StatisticalRethinking, CmdStan, StanMCMCChains
gr(size=(500,500));</code></pre><pre><code class="language-none">Plots.GRBackend()</code></pre></div><p>CmdStan uses a tmp directory to store the output of cmdstan</p><div><pre><code class="language-julia">ProjDir = rel_path(&quot;..&quot;, &quot;scripts&quot;, &quot;04&quot;)
cd(ProjDir)</code></pre></div><h3><a class="nav-anchor" id="snippet-4.7-1" href="#snippet-4.7-1">snippet 4.7</a></h3><div><pre><code class="language-julia">howell1 = CSV.read(rel_path(&quot;..&quot;, &quot;data&quot;, &quot;Howell1.csv&quot;), delim=&#39;;&#39;)
df = convert(DataFrame, howell1);</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>544 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr><tr><th>6</th><td>163.83</td><td>62.9926</td><td>35.0</td><td>1</td></tr><tr><th>7</th><td>149.225</td><td>38.2435</td><td>32.0</td><td>0</td></tr><tr><th>8</th><td>168.91</td><td>55.48</td><td>27.0</td><td>1</td></tr><tr><th>9</th><td>147.955</td><td>34.8699</td><td>19.0</td><td>0</td></tr><tr><th>10</th><td>165.1</td><td>54.4877</td><td>54.0</td><td>1</td></tr><tr><th>11</th><td>154.305</td><td>49.8951</td><td>47.0</td><td>0</td></tr><tr><th>12</th><td>151.13</td><td>41.2202</td><td>66.0</td><td>1</td></tr><tr><th>13</th><td>144.78</td><td>36.0322</td><td>73.0</td><td>0</td></tr><tr><th>14</th><td>149.9</td><td>47.7</td><td>20.0</td><td>0</td></tr><tr><th>15</th><td>150.495</td><td>33.8493</td><td>65.3</td><td>0</td></tr><tr><th>16</th><td>163.195</td><td>48.5627</td><td>36.0</td><td>1</td></tr><tr><th>17</th><td>157.48</td><td>42.3258</td><td>44.0</td><td>1</td></tr><tr><th>18</th><td>143.942</td><td>38.3569</td><td>31.0</td><td>0</td></tr><tr><th>19</th><td>121.92</td><td>19.6179</td><td>12.0</td><td>1</td></tr><tr><th>20</th><td>105.41</td><td>13.948</td><td>8.0</td><td>0</td></tr><tr><th>21</th><td>86.36</td><td>10.4893</td><td>6.5</td><td>0</td></tr><tr><th>22</th><td>161.29</td><td>48.9879</td><td>39.0</td><td>1</td></tr><tr><th>23</th><td>156.21</td><td>42.7227</td><td>29.0</td><td>0</td></tr><tr><th>24</th><td>129.54</td><td>23.5868</td><td>13.0</td><td>1</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><h3><a class="nav-anchor" id="snippet-4.8-1" href="#snippet-4.8-1">snippet 4.8</a></h3><p>Use only adults</p><div><pre><code class="language-julia">df2 = filter(row -&gt; row[:age] &gt;= 18, df);</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>352 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr><tr><th>6</th><td>163.83</td><td>62.9926</td><td>35.0</td><td>1</td></tr><tr><th>7</th><td>149.225</td><td>38.2435</td><td>32.0</td><td>0</td></tr><tr><th>8</th><td>168.91</td><td>55.48</td><td>27.0</td><td>1</td></tr><tr><th>9</th><td>147.955</td><td>34.8699</td><td>19.0</td><td>0</td></tr><tr><th>10</th><td>165.1</td><td>54.4877</td><td>54.0</td><td>1</td></tr><tr><th>11</th><td>154.305</td><td>49.8951</td><td>47.0</td><td>0</td></tr><tr><th>12</th><td>151.13</td><td>41.2202</td><td>66.0</td><td>1</td></tr><tr><th>13</th><td>144.78</td><td>36.0322</td><td>73.0</td><td>0</td></tr><tr><th>14</th><td>149.9</td><td>47.7</td><td>20.0</td><td>0</td></tr><tr><th>15</th><td>150.495</td><td>33.8493</td><td>65.3</td><td>0</td></tr><tr><th>16</th><td>163.195</td><td>48.5627</td><td>36.0</td><td>1</td></tr><tr><th>17</th><td>157.48</td><td>42.3258</td><td>44.0</td><td>1</td></tr><tr><th>18</th><td>143.942</td><td>38.3569</td><td>31.0</td><td>0</td></tr><tr><th>19</th><td>161.29</td><td>48.9879</td><td>39.0</td><td>1</td></tr><tr><th>20</th><td>156.21</td><td>42.7227</td><td>29.0</td><td>0</td></tr><tr><th>21</th><td>146.4</td><td>35.4936</td><td>56.0</td><td>1</td></tr><tr><th>22</th><td>148.59</td><td>37.9033</td><td>45.0</td><td>0</td></tr><tr><th>23</th><td>147.32</td><td>35.4652</td><td>19.0</td><td>0</td></tr><tr><th>24</th><td>147.955</td><td>40.313</td><td>29.0</td><td>1</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><p>Show first 5 rows of DataFrame df</p><div><pre><code class="language-julia">first(df2, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>5 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.14-1" href="#Snippet-4.14-1">Snippet 4.14</a></h3><p>Generate approximate probabilities</p><div><pre><code class="language-julia">struct Post
  mu::Float64
  sigma::Float64
  ll:: Float64
  prod::Float64
  prob::Float64
end

mu_list = repeat(range(140, 160, length=200), 200);
sigma_list = repeat(range(4, 9, length=200), inner=200);

ll = zeros(40000);
for i in 1:40000
    d1 = Normal(mu_list[i], sigma_list[i])
    ll[i] = sum(log.(pdf.(d1, df2[:height])))
end

d2 = Normal(178.0, 20.0)
d3 = Uniform(0, 50)
prod = ll + log.(pdf.(d2, mu_list)) + log.(pdf.(d3, sigma_list))
prob = exp.(prod .- maximum(prod))
post = DataFrame(mu=mu_list, sigma=sigma_list, ll=ll, prod=prod, prob=prob)
first(post, 10)</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10 rows × 5 columns</p><tr><th>1</th><td>140.0</td><td>4.0</td><td>-3812.78</td><td>-3822.41</td><td>0.0</td></tr><tr><th>2</th><td>140.101</td><td>4.0</td><td>-3780.61</td><td>-3790.23</td><td>0.0</td></tr><tr><th>3</th><td>140.201</td><td>4.0</td><td>-3748.67</td><td>-3758.28</td><td>0.0</td></tr><tr><th>4</th><td>140.302</td><td>4.0</td><td>-3716.95</td><td>-3726.55</td><td>0.0</td></tr><tr><th>5</th><td>140.402</td><td>4.0</td><td>-3685.45</td><td>-3695.05</td><td>0.0</td></tr><tr><th>6</th><td>140.503</td><td>4.0</td><td>-3654.18</td><td>-3663.76</td><td>0.0</td></tr><tr><th>7</th><td>140.603</td><td>4.0</td><td>-3623.13</td><td>-3632.7</td><td>0.0</td></tr><tr><th>8</th><td>140.704</td><td>4.0</td><td>-3592.3</td><td>-3601.86</td><td>0.0</td></tr><tr><th>9</th><td>140.804</td><td>4.0</td><td>-3561.69</td><td>-3571.24</td><td>0.0</td></tr><tr><th>10</th><td>140.905</td><td>4.0</td><td>-3531.3</td><td>-3540.85</td><td>0.0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.15-1" href="#Snippet-4.15-1">Snippet 4.15</a></h3><p>Sample post</p><div><pre><code class="language-julia">samples = post[sample(1:size(post, 1), Weights(post[:prob]), 10000, replace=true), :]</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10,000 rows × 5 columns</p><tr><th>1</th><td>154.774</td><td>8.04523</td><td>-1220.03</td><td>-1228.53</td><td>0.541365</td></tr><tr><th>2</th><td>154.372</td><td>7.31658</td><td>-1220.68</td><td>-1229.21</td><td>0.276224</td></tr><tr><th>3</th><td>154.372</td><td>7.39196</td><td>-1220.3</td><td>-1228.82</td><td>0.405128</td></tr><tr><th>4</th><td>154.774</td><td>7.8191</td><td>-1219.54</td><td>-1228.04</td><td>0.886803</td></tr><tr><th>5</th><td>154.573</td><td>7.26633</td><td>-1220.82</td><td>-1229.33</td><td>0.243785</td></tr><tr><th>6</th><td>154.171</td><td>7.74372</td><td>-1219.94</td><td>-1228.48</td><td>0.573924</td></tr><tr><th>7</th><td>153.97</td><td>8.04523</td><td>-1221.02</td><td>-1229.57</td><td>0.19282</td></tr><tr><th>8</th><td>154.673</td><td>7.24121</td><td>-1221.0</td><td>-1229.51</td><td>0.20413</td></tr><tr><th>9</th><td>154.774</td><td>7.79397</td><td>-1219.52</td><td>-1228.02</td><td>0.905748</td></tr><tr><th>10</th><td>154.573</td><td>7.49246</td><td>-1219.76</td><td>-1228.27</td><td>0.70239</td></tr><tr><th>11</th><td>154.673</td><td>8.24623</td><td>-1220.82</td><td>-1229.33</td><td>0.244401</td></tr><tr><th>12</th><td>155.075</td><td>7.64322</td><td>-1220.14</td><td>-1228.62</td><td>0.494583</td></tr><tr><th>13</th><td>154.874</td><td>7.99497</td><td>-1220.0</td><td>-1228.5</td><td>0.560667</td></tr><tr><th>14</th><td>153.869</td><td>7.94472</td><td>-1221.14</td><td>-1229.69</td><td>0.16995</td></tr><tr><th>15</th><td>155.075</td><td>8.14573</td><td>-1220.94</td><td>-1229.42</td><td>0.22266</td></tr><tr><th>16</th><td>154.975</td><td>8.14573</td><td>-1220.71</td><td>-1229.2</td><td>0.278128</td></tr><tr><th>17</th><td>154.07</td><td>7.79397</td><td>-1220.23</td><td>-1228.77</td><td>0.425794</td></tr><tr><th>18</th><td>154.372</td><td>6.8392</td><td>-1225.35</td><td>-1233.87</td><td>0.00260007</td></tr><tr><th>19</th><td>155.578</td><td>7.76884</td><td>-1222.22</td><td>-1230.67</td><td>0.0637262</td></tr><tr><th>20</th><td>154.975</td><td>7.89447</td><td>-1219.96</td><td>-1228.45</td><td>0.589515</td></tr><tr><th>21</th><td>155.276</td><td>7.74372</td><td>-1220.76</td><td>-1229.23</td><td>0.269276</td></tr><tr><th>22</th><td>154.975</td><td>7.86935</td><td>-1219.92</td><td>-1228.41</td><td>0.613502</td></tr><tr><th>23</th><td>154.975</td><td>7.61809</td><td>-1219.92</td><td>-1228.4</td><td>0.616167</td></tr><tr><th>24</th><td>154.874</td><td>7.19095</td><td>-1221.61</td><td>-1230.1</td><td>0.112806</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.19-1" href="#Snippet-4.19-1">Snippet 4.19</a></h3><p>Density of mu</p><div><pre><code class="language-julia">density(samples[:mu])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip6400">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6400)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6401">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6400)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6402">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  170.284,1937.01 170.284,47.2441 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  670.826,1937.01 670.826,47.2441 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1171.37,1937.01 1171.37,47.2441 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1671.91,1937.01 1671.91,47.2441 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1506.78 1921.26,1506.78 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1130.04 1921.26,1130.04 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,753.305 1921.26,753.305 
  "/>
<polyline clip-path="url(#clip6402)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,376.564 1921.26,376.564 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  170.284,1937.01 170.284,1908.66 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  670.826,1937.01 670.826,1908.66 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1171.37,1937.01 1171.37,1908.66 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1671.91,1937.01 1671.91,1908.66 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1506.78 121.89,1506.78 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1130.04 121.89,1130.04 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,753.305 121.89,753.305 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,376.564 121.89,376.564 
  "/>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 170.284, 1989.01)" x="170.284" y="1989.01">153</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 670.826, 1989.01)" x="670.826" y="1989.01">154</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1171.37, 1989.01)" x="1171.37" y="1989.01">155</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1671.91, 1989.01)" x="1671.91" y="1989.01">156</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.0</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1524.28)" x="74.4882" y="1524.28">0.2</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1147.54)" x="74.4882" y="1147.54">0.4</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 770.805)" x="74.4882" y="770.805">0.6</text>
</g>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 394.064)" x="74.4882" y="394.064">0.8</text>
</g>
<polyline clip-path="url(#clip6402)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.51 172.17,1883.48 180.83,1883.41 189.49,1883.26 198.15,1882.99 206.81,1882.54 215.47,1881.87 224.131,1880.97 
  232.791,1879.86 241.451,1878.56 250.111,1877.03 258.771,1875.18 267.431,1872.9 276.091,1870.19 284.752,1867.17 293.412,1864.12 302.072,1861.22 310.732,1858.43 
  319.392,1855.57 328.052,1852.49 336.713,1849.37 345.373,1846.76 354.033,1845.21 362.693,1844.89 371.353,1845.43 380.013,1846.12 388.673,1846.31 397.334,1845.62 
  405.994,1843.9 414.654,1840.99 423.314,1836.74 431.974,1831.12 440.634,1824.35 449.294,1816.73 457.955,1808.24 466.615,1798.42 475.275,1786.78 483.935,1773.39 
  492.595,1759.13 501.255,1745 509.915,1731.17 518.576,1716.67 527.236,1700.19 535.896,1681.4 544.556,1661.31 553.216,1641.14 561.876,1620.68 570.537,1598.04 
  579.197,1571.45 587.857,1541.43 596.517,1511.13 605.177,1483.81 613.837,1459.76 622.497,1435.75 631.158,1407.85 639.818,1375.11 648.478,1340.13 657.138,1305.96 
  665.798,1272.29 674.458,1235.39 683.118,1192.2 691.779,1144.44 700.439,1098.04 709.099,1057.93 717.759,1023.11 726.419,987.602 735.079,946.647 743.739,901.956 
  752.4,860.303 761.06,826.434 769.72,797.574 778.38,765.557 787.04,724.711 795.7,677.201 804.361,629.841 813.021,585.537 821.681,538.904 830.341,481.843 
  839.001,414.099 847.661,347.463 856.321,297.733 864.982,271.134 873.642,258.535 882.302,243.816 890.962,218.623 899.622,189.013 908.282,167.562 916.942,159.322 
  925.603,156.312 934.263,146.21 942.923,126.019 951.583,106.197 960.243,100.728 968.903,113.281 977.563,133.631 986.224,147.768 994.884,150.976 1003.54,150.489 
  1012.2,155.688 1020.86,166.974 1029.52,175.559 1038.18,174.367 1046.84,168.08 1055.5,171.004 1064.16,194.291 1072.83,235.397 1081.49,280.652 1090.15,318.355 
  1098.81,349.178 1107.47,383.664 1116.13,430.018 1124.79,485.063 1133.45,537.44 1142.11,579.224 1150.77,613.775 1159.43,651.994 1168.09,701.292 1176.75,758.589 
  1185.41,813.924 1194.07,860.283 1202.73,899.521 1211.39,939.079 1220.05,983.778 1228.71,1031.35 1237.37,1075.68 1246.03,1113.67 1254.69,1148.32 1263.35,1185.37 
  1272.01,1227.41 1280.67,1271.64 1289.33,1313.02 1297.99,1349.25 1306.65,1382.38 1315.31,1416.05 1323.97,1451.51 1332.63,1486.51 1341.29,1517.78 1349.95,1544.13 
  1358.61,1567.05 1367.27,1588.7 1375.93,1609.59 1384.59,1628.46 1393.25,1644.2 1401.91,1657.49 1410.57,1670.47 1419.23,1684.95 1427.89,1700.83 1436.55,1716.5 
  1445.21,1730.45 1453.87,1742.58 1462.53,1754.01 1471.19,1765.79 1479.85,1777.94 1488.51,1789.56 1497.17,1799.73 1505.83,1808.25 1514.49,1815.55 1523.15,1822.14 
  1531.81,1828.16 1540.47,1833.48 1549.13,1838.12 1557.79,1842.42 1566.45,1846.84 1575.11,1851.63 1583.77,1856.61 1592.43,1861.32 1601.09,1865.37 1609.75,1868.61 
  1618.41,1871.13 1627.07,1873.09 1635.73,1874.62 1644.39,1875.81 1653.06,1876.75 1661.72,1877.55 1670.38,1878.31 1679.04,1879.06 1687.7,1879.77 1696.36,1880.38 
  1705.02,1880.86 1713.68,1881.2 1722.34,1881.43 1731,1881.57 1739.66,1881.66 1748.32,1881.72 1756.98,1881.81 1765.64,1881.95 1774.3,1882.16 1782.96,1882.44 
  1791.62,1882.73 1800.28,1882.99 1808.94,1883.2 1817.6,1883.35 1826.26,1883.44 1834.92,1883.49 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip6400)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6400)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip6400)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip6400)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><p>Density of sigma</p><div><pre><code class="language-julia">density(samples[:sigma])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip6500">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6500)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6501">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6500)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6502">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  380.134,1937.01 380.134,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  736.032,1937.01 736.032,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1091.93,1937.01 1091.93,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1447.83,1937.01 1447.83,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1803.73,1937.01 1803.73,47.2441 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.53 1921.26,1883.53 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1511.46 1921.26,1511.46 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1139.39 1921.26,1139.39 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,767.318 1921.26,767.318 
  "/>
<polyline clip-path="url(#clip6502)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,395.249 1921.26,395.249 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  380.134,1937.01 380.134,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  736.032,1937.01 736.032,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1091.93,1937.01 1091.93,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1447.83,1937.01 1447.83,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1803.73,1937.01 1803.73,1908.66 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.53 121.89,1883.53 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1511.46 121.89,1511.46 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1139.39 121.89,1139.39 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,767.318 121.89,767.318 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,395.249 121.89,395.249 
  "/>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 380.134, 1989.01)" x="380.134" y="1989.01">7.0</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 736.032, 1989.01)" x="736.032" y="1989.01">7.5</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1091.93, 1989.01)" x="1091.93" y="1989.01">8.0</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1447.83, 1989.01)" x="1447.83" y="1989.01">8.5</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1803.73, 1989.01)" x="1803.73" y="1989.01">9.0</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.03)" x="74.4882" y="1901.03">0.0</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1528.96)" x="74.4882" y="1528.96">0.3</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1156.89)" x="74.4882" y="1156.89">0.6</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 784.818)" x="74.4882" y="784.818">0.9</text>
</g>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 412.749)" x="74.4882" y="412.749">1.2</text>
</g>
<polyline clip-path="url(#clip6502)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.51 172.17,1883.49 180.83,1883.45 189.49,1883.35 198.15,1883.17 206.81,1882.85 215.47,1882.34 224.131,1881.57 
  232.791,1880.52 241.451,1879.2 250.111,1877.7 258.771,1876.11 267.431,1874.56 276.091,1873.14 284.752,1871.87 293.412,1870.72 302.072,1869.61 310.732,1868.41 
  319.392,1867.03 328.052,1865.39 336.713,1863.43 345.373,1861.06 354.033,1858.23 362.693,1854.81 371.353,1850.7 380.013,1845.76 388.673,1839.95 397.334,1833.27 
  405.994,1825.83 414.654,1817.74 423.314,1809.08 431.974,1799.77 440.634,1789.56 449.294,1778.06 457.955,1764.88 466.615,1749.7 475.275,1732.33 483.935,1712.79 
  492.595,1691.15 501.255,1667.62 509.915,1642.46 518.576,1616.03 527.236,1588.69 535.896,1560.8 544.556,1532.58 553.216,1504.13 561.876,1475.56 570.537,1447.13 
  579.197,1419.34 587.857,1392.81 596.517,1367.97 605.177,1344.71 613.837,1322.23 622.497,1299.03 631.158,1273.35 639.818,1243.6 648.478,1208.82 657.138,1168.91 
  665.798,1124.5 674.458,1076.81 683.118,1027.17 691.779,976.799 700.439,926.489 709.099,876.593 717.759,827.125 726.419,777.992 735.079,729.281 743.739,681.45 
  752.4,635.342 761.06,591.983 769.72,552.238 778.38,516.479 787.04,484.439 795.7,455.337 804.361,428.238 813.021,402.452 821.681,377.78 830.341,354.454 
  839.001,332.806 847.661,312.805 856.321,293.718 864.982,274.129 873.642,252.38 882.302,227.317 890.962,199 899.622,169.069 908.282,140.57 916.942,117.333 
  925.603,103.101 934.263,100.728 942.923,111.614 951.583,135.486 960.243,170.515 968.903,213.686 977.563,261.317 986.224,309.618 994.884,355.256 1003.54,395.866 
  1012.2,430.46 1020.86,459.601 1029.52,485.229 1038.18,510.1 1046.84,536.993 1055.5,567.936 1064.16,603.722 1072.83,643.845 1081.49,686.827 1090.15,730.74 
  1098.81,773.745 1107.47,814.504 1116.13,852.413 1124.79,887.656 1133.45,921.095 1142.11,954.006 1150.77,987.705 1159.43,1023.17 1168.09,1060.77 1176.75,1100.16 
  1185.41,1140.45 1194.07,1180.43 1202.73,1218.9 1211.39,1254.96 1220.05,1288.19 1228.71,1318.71 1237.37,1347.01 1246.03,1373.72 1254.69,1399.28 1263.35,1423.77 
  1272.01,1446.99 1280.67,1468.71 1289.33,1488.95 1297.99,1508.16 1306.65,1527.13 1315.31,1546.71 1323.97,1567.54 1332.63,1589.81 1341.29,1613.26 1349.95,1637.27 
  1358.61,1661 1367.27,1683.6 1375.93,1704.3 1384.59,1722.53 1393.25,1737.99 1401.91,1750.64 1410.57,1760.75 1419.23,1768.82 1427.89,1775.48 1436.55,1781.38 
  1445.21,1787.09 1453.87,1793.01 1462.53,1799.39 1471.19,1806.3 1479.85,1813.68 1488.51,1821.37 1497.17,1829.14 1505.83,1836.72 1514.49,1843.81 1523.15,1850.15 
  1531.81,1855.52 1540.47,1859.75 1549.13,1862.78 1557.79,1864.58 1566.45,1865.28 1575.11,1865.06 1583.77,1864.19 1592.43,1862.99 1601.09,1861.76 1609.75,1860.78 
  1618.41,1860.26 1627.07,1860.33 1635.73,1861.09 1644.39,1862.51 1653.06,1864.5 1661.72,1866.89 1670.38,1869.43 1679.04,1871.88 1687.7,1874.01 1696.36,1875.7 
  1705.02,1876.91 1713.68,1877.69 1722.34,1878.15 1731,1878.43 1739.66,1878.67 1748.32,1878.99 1756.98,1879.46 1765.64,1880.08 1774.3,1880.78 1782.96,1881.49 
  1791.62,1882.12 1800.28,1882.63 1808.94,1883 1817.6,1883.24 1826.26,1883.38 1834.92,1883.46 1843.58,1883.5 1852.24,1883.51 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip6500)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6500)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip6500)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip6500)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><h3><a class="nav-anchor" id="Snippet-4.20-1" href="#Snippet-4.20-1">Snippet 4.20</a></h3><p>Hdp mu</p><div><pre><code class="language-julia">MCMCChains.hpd(samples[:mu])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 153.66834170854273
 155.27638190954775</code></pre></div><p>Hdp sigma</p><div><pre><code class="language-julia">MCMCChains.hpd(samples[:sigma])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 7.190954773869347
 8.321608040201005</code></pre></div><p>End of <code>clip-14-20.jl</code></p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../clip-07-13s/"><span class="direction">Previous</span><span class="title">clip-07-13s</span></a><a class="next" href="../clip-21-23/"><span class="direction">Next</span><span class="title">clip-21-23</span></a></footer></article></body></html>
