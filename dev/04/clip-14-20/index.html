<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>clip-14-20 · StatisticalRethinking.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>StatisticalRethinking.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><a class="toctext" href="../../layout/">Layout</a></li><li><a class="toctext" href="../../acknowledgements/">Acknowledgements</a></li><li><a class="toctext" href="../../references/">References</a></li><li><span class="toctext">Chapter 00</span><ul><li><a class="toctext" href="../../00/clip-01-03/">clip-01-03</a></li><li><a class="toctext" href="../../00/clip-04-05/">clip-04-05</a></li></ul></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/clip-01-02/">clip-01-02</a></li><li><a class="toctext" href="../../02/clip-03-05/">clip-03-05</a></li><li><a class="toctext" href="../../02/clip-06-07/">clip-06-07</a></li><li><a class="toctext" href="../../02/clip-08d/">clip-08d</a></li><li><a class="toctext" href="../../02/clip-08s/">clip-08s</a></li><li><a class="toctext" href="../../02/clip-08t/">clip-08t</a></li></ul></li><li><span class="toctext">Chapter 03</span><ul><li><a class="toctext" href="../../03/clip-01/">clip-01</a></li><li><a class="toctext" href="../../03/clip-02-05/">clip-02-05</a></li><li><a class="toctext" href="../../03/clip-05s/">clip-05s</a></li><li><a class="toctext" href="../../03/clip-06-16s/">clip-06-16s</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../m4.1d/">m4.1d</a></li><li><a class="toctext" href="../m4.1s/">m4.1s</a></li><li><a class="toctext" href="../m4.2d/">m4.2d</a></li><li><a class="toctext" href="../m4.2s/">m4.2s</a></li><li><a class="toctext" href="../m4.2t/">m4.2t</a></li><li><a class="toctext" href="../m4.3s/">m4.3s</a></li><li><a class="toctext" href="../m4.4s/">m4.4s</a></li><li><a class="toctext" href="../m4.5d/">m4.5d</a></li><li><a class="toctext" href="../m4.5d1/">m4.5d1</a></li><li><a class="toctext" href="../m4.5s/">m4.5s</a></li><li><a class="toctext" href="../clip-01-06/">clip-01-06</a></li><li><a class="toctext" href="../clip-07-13s/">clip-07-13s</a></li><li class="current"><a class="toctext" href>clip-14-20</a><ul class="internal"></ul></li><li><a class="toctext" href="../clip-21-23/">clip-21-23</a></li><li><a class="toctext" href="../clip-24-29s/">clip-24-29s</a></li><li><a class="toctext" href="../clip-30s/">clip-30s</a></li><li><a class="toctext" href="../clip-38s/">clip-38s</a></li><li><a class="toctext" href="../clip-43s/">clip-43s</a></li><li><a class="toctext" href="../clip-45-47s/">clip-45-47s</a></li><li><a class="toctext" href="../clip-48-54s/">clip-48-54s</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/clip-01d/">clip-01d</a></li><li><a class="toctext" href="../../05/clip-01s/">clip-01s</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1/">m8.1</a></li><li><a class="toctext" href="../../08/m8.3/">m8.3</a></li></ul></li><li><span class="toctext">Chapter 10</span></li><li><span class="toctext">Chapter 11</span></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../../12/m12.6.1s/">m12.6.1s</a></li><li><a class="toctext" href="../../12/m12.6.2s/">m12.6.2s</a></li></ul></li><li><span class="toctext">Chapter 13</span><ul><li><a class="toctext" href="../../13/m13.2s/">m13.2s</a></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 04</li><li><a href>clip-14-20</a></li></ul><a class="edit-page" href="https://github.com/StanJulia/StatisticalRethinking.jl/blob/master/scripts/04/clip-14-20.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>clip-14-20</span><a class="fa fa-bars" href="#"></a></div></header><p>Load Julia packages (libraries) needed  for the snippets in chapter 0</p><div><pre><code class="language-julia">using StatisticalRethinking, CmdStan, StanMCMCChain
gr(size=(500,500));</code></pre></div><p>CmdStan uses a tmp directory to store the output of cmdstan</p><div><pre><code class="language-julia">ProjDir = rel_path(&quot;..&quot;, &quot;scripts&quot;, &quot;04&quot;)
cd(ProjDir)</code></pre></div><h3><a class="nav-anchor" id="snippet-4.7-1" href="#snippet-4.7-1">snippet 4.7</a></h3><div><pre><code class="language-julia">howell1 = CSV.read(rel_path(&quot;..&quot;, &quot;data&quot;, &quot;Howell1.csv&quot;), delim=&#39;;&#39;)
df = convert(DataFrame, howell1);</code></pre></div><h3><a class="nav-anchor" id="snippet-4.8-1" href="#snippet-4.8-1">snippet 4.8</a></h3><p>Use only adults</p><div><pre><code class="language-julia">df2 = filter(row -&gt; row[:age] &gt;= 18, df);</code></pre></div><p>Show first 5 rows of DataFrame df</p><div><pre><code class="language-julia">first(df2, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>5 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.14-1" href="#Snippet-4.14-1">Snippet 4.14</a></h3><p>Generate approximate probabilities</p><div><pre><code class="language-julia">struct Post
  mu::Float64
  sigma::Float64
  ll:: Float64
  prod::Float64
  prob::Float64
end

mu_list = repeat(range(140, 160, length=200), 200);
sigma_list = repeat(range(4, 9, length=200), inner=200);

ll = zeros(40000);
for i in 1:40000
    d1 = Normal(mu_list[i], sigma_list[i])
    ll[i] = sum(log.(pdf.(d1, df2[:height])))
end

d2 = Normal(178.0, 20.0)
d3 = Uniform(0, 50)
prod = ll + log.(pdf.(d2, mu_list)) + log.(pdf.(d3, sigma_list))
prob = exp.(prod .- maximum(prod))
post = DataFrame(mu=mu_list, sigma=sigma_list, ll=ll, prod=prod, prob=prob)
first(post, 10)</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10 rows × 5 columns</p><tr><th>1</th><td>140.0</td><td>4.0</td><td>-3812.78</td><td>-3822.41</td><td>0.0</td></tr><tr><th>2</th><td>140.101</td><td>4.0</td><td>-3780.61</td><td>-3790.23</td><td>0.0</td></tr><tr><th>3</th><td>140.201</td><td>4.0</td><td>-3748.67</td><td>-3758.28</td><td>0.0</td></tr><tr><th>4</th><td>140.302</td><td>4.0</td><td>-3716.95</td><td>-3726.55</td><td>0.0</td></tr><tr><th>5</th><td>140.402</td><td>4.0</td><td>-3685.45</td><td>-3695.05</td><td>0.0</td></tr><tr><th>6</th><td>140.503</td><td>4.0</td><td>-3654.18</td><td>-3663.76</td><td>0.0</td></tr><tr><th>7</th><td>140.603</td><td>4.0</td><td>-3623.13</td><td>-3632.7</td><td>0.0</td></tr><tr><th>8</th><td>140.704</td><td>4.0</td><td>-3592.3</td><td>-3601.86</td><td>0.0</td></tr><tr><th>9</th><td>140.804</td><td>4.0</td><td>-3561.69</td><td>-3571.24</td><td>0.0</td></tr><tr><th>10</th><td>140.905</td><td>4.0</td><td>-3531.3</td><td>-3540.85</td><td>0.0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.15-1" href="#Snippet-4.15-1">Snippet 4.15</a></h3><p>Sample post</p><div><pre><code class="language-julia">samples = post[sample(1:size(post, 1), Weights(post[:prob]), 10000, replace=true), :]</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10,000 rows × 5 columns</p><tr><th>1</th><td>154.975</td><td>7.59296</td><td>-1219.96</td><td>-1228.45</td><td>0.591023</td></tr><tr><th>2</th><td>154.975</td><td>7.86935</td><td>-1219.92</td><td>-1228.41</td><td>0.613502</td></tr><tr><th>3</th><td>154.372</td><td>7.44221</td><td>-1220.09</td><td>-1228.62</td><td>0.499101</td></tr><tr><th>4</th><td>154.874</td><td>7.59296</td><td>-1219.76</td><td>-1228.25</td><td>0.718407</td></tr><tr><th>5</th><td>155.276</td><td>7.74372</td><td>-1220.76</td><td>-1229.23</td><td>0.269276</td></tr><tr><th>6</th><td>154.673</td><td>7.66834</td><td>-1219.45</td><td>-1227.95</td><td>0.967929</td></tr><tr><th>7</th><td>154.874</td><td>7.09045</td><td>-1222.47</td><td>-1230.96</td><td>0.0476676</td></tr><tr><th>8</th><td>154.171</td><td>7.96985</td><td>-1220.23</td><td>-1228.76</td><td>0.430405</td></tr><tr><th>9</th><td>154.975</td><td>7.8191</td><td>-1219.86</td><td>-1228.35</td><td>0.6509</td></tr><tr><th>10</th><td>154.472</td><td>7.41709</td><td>-1220.08</td><td>-1228.6</td><td>0.50853</td></tr><tr><th>11</th><td>154.673</td><td>7.89447</td><td>-1219.57</td><td>-1228.08</td><td>0.852729</td></tr><tr><th>12</th><td>154.372</td><td>7.29146</td><td>-1220.83</td><td>-1229.35</td><td>0.238467</td></tr><tr><th>13</th><td>155.276</td><td>7.86935</td><td>-1220.83</td><td>-1229.3</td><td>0.252299</td></tr><tr><th>14</th><td>154.774</td><td>7.84422</td><td>-1219.57</td><td>-1228.07</td><td>0.862171</td></tr><tr><th>15</th><td>153.869</td><td>7.66834</td><td>-1221.01</td><td>-1229.57</td><td>0.192429</td></tr><tr><th>16</th><td>154.271</td><td>7.8191</td><td>-1219.76</td><td>-1228.29</td><td>0.69412</td></tr><tr><th>17</th><td>154.372</td><td>7.49246</td><td>-1219.92</td><td>-1228.44</td><td>0.593157</td></tr><tr><th>18</th><td>154.774</td><td>7.69347</td><td>-1219.51</td><td>-1228.01</td><td>0.916599</td></tr><tr><th>19</th><td>155.075</td><td>7.79397</td><td>-1220.09</td><td>-1228.57</td><td>0.520046</td></tr><tr><th>20</th><td>154.573</td><td>7.49246</td><td>-1219.76</td><td>-1228.27</td><td>0.70239</td></tr><tr><th>21</th><td>154.472</td><td>7.76884</td><td>-1219.46</td><td>-1227.98</td><td>0.944722</td></tr><tr><th>22</th><td>155.176</td><td>7.56784</td><td>-1220.6</td><td>-1229.08</td><td>0.315034</td></tr><tr><th>23</th><td>154.774</td><td>7.66834</td><td>-1219.52</td><td>-1228.02</td><td>0.902246</td></tr><tr><th>24</th><td>154.874</td><td>7.51759</td><td>-1219.93</td><td>-1228.42</td><td>0.60582</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.19-1" href="#Snippet-4.19-1">Snippet 4.19</a></h3><p>Density of mu</p><div><pre><code class="language-julia">density(samples[:mu])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip8700">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip8700)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip8701">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip8700)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip8702">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  216.486,1937.01 216.486,47.2441 
  "/>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  689.417,1937.01 689.417,47.2441 
  "/>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1162.35,1937.01 1162.35,47.2441 
  "/>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1635.28,1937.01 1635.28,47.2441 
  "/>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1431.29 1921.26,1431.29 
  "/>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,979.047 1921.26,979.047 
  "/>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,526.808 1921.26,526.808 
  "/>
<polyline clip-path="url(#clip8702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,74.5685 1921.26,74.5685 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  216.486,1937.01 216.486,1908.66 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  689.417,1937.01 689.417,1908.66 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1162.35,1937.01 1162.35,1908.66 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1635.28,1937.01 1635.28,1908.66 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1431.29 121.89,1431.29 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,979.047 121.89,979.047 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,526.808 121.89,526.808 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,74.5685 121.89,74.5685 
  "/>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 216.486, 1989.01)" x="216.486" y="1989.01">153</text>
</g>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 689.417, 1989.01)" x="689.417" y="1989.01">154</text>
</g>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1162.35, 1989.01)" x="1162.35" y="1989.01">155</text>
</g>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1635.28, 1989.01)" x="1635.28" y="1989.01">156</text>
</g>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.00</text>
</g>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1448.79)" x="74.4882" y="1448.79">0.25</text>
</g>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 996.547)" x="74.4882" y="996.547">0.50</text>
</g>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 544.308)" x="74.4882" y="544.308">0.75</text>
</g>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 92.0685)" x="74.4882" y="92.0685">1.00</text>
</g>
<polyline clip-path="url(#clip8702)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.51 172.17,1883.49 180.83,1883.43 189.49,1883.32 198.15,1883.1 206.81,1882.76 215.47,1882.28 224.131,1881.7 
  232.791,1881.12 241.451,1880.63 250.111,1880.29 258.771,1880.1 267.431,1879.99 276.091,1879.87 284.752,1879.7 293.412,1879.46 302.072,1879.1 310.732,1878.6 
  319.392,1877.92 328.052,1877.04 336.713,1875.96 345.373,1874.62 354.033,1872.93 362.693,1870.81 371.353,1868.32 380.013,1865.65 388.673,1862.94 397.334,1860.15 
  405.994,1857.05 414.654,1853.46 423.314,1849.5 431.974,1845.44 440.634,1841.42 449.294,1837.19 457.955,1832.27 466.615,1826.48 475.275,1820.06 483.935,1813.37 
  492.595,1806.32 501.255,1798.26 509.915,1788.68 518.576,1777.88 527.236,1766.72 535.896,1755.64 544.556,1743.96 553.216,1730.4 561.876,1714.58 570.537,1697.59 
  579.197,1680.9 587.857,1664.51 596.517,1646.55 605.177,1625 613.837,1599.57 622.497,1571.52 631.158,1541.23 639.818,1506.64 648.478,1465.01 657.138,1416.67 
  665.798,1366.27 674.458,1319.16 683.118,1276.13 691.779,1232.52 700.439,1183.61 709.099,1130.72 717.759,1080.96 726.419,1039.95 735.079,1005.31 743.739,968.91 
  752.4,925.903 761.06,880.803 769.72,842.983 778.38,816.123 787.04,793.508 795.7,764.897 804.361,727.397 813.021,687.71 821.681,652.983 830.341,621.087 
  839.001,582.412 847.661,531.869 856.321,477.055 864.982,431.994 873.642,402.47 882.302,379.564 890.962,349.396 899.622,308.404 908.282,266.61 916.942,234.982 
  925.603,211.824 934.263,184.947 942.923,148.128 951.583,112.894 960.243,100.728 968.903,122.648 977.563,167.857 986.224,213.619 994.884,245.282 1003.54,265.037 
  1012.2,281.9 1020.86,296.916 1029.52,301.772 1038.18,291.888 1046.84,277.173 1055.5,276.096 1064.16,298.495 1072.83,336.219 1081.49,372.278 1090.15,398.348 
  1098.81,421.464 1107.47,453.514 1116.13,496.571 1124.79,540.898 1133.45,577.136 1142.11,607.942 1150.77,645.602 1159.43,698.611 1168.09,762.477 1176.75,824.584 
  1185.41,876.892 1194.07,922.348 1202.73,969.021 1211.39,1019.9 1220.05,1070.04 1228.71,1113.15 1237.37,1149.21 1246.03,1184.3 1254.69,1223.48 1263.35,1265.53 
  1272.01,1305.05 1280.67,1339.18 1289.33,1370.89 1297.99,1405.7 1306.65,1445.7 1315.31,1487.57 1323.97,1525.97 1332.63,1558.19 1341.29,1585.24 1349.95,1609.27 
  1358.61,1630.83 1367.27,1649.14 1375.93,1664.21 1384.59,1678.03 1393.25,1693.25 1401.91,1710.84 1410.57,1729.44 1419.23,1746.75 1427.89,1761.5 1436.55,1773.99 
  1445.21,1785.09 1453.87,1795.12 1462.53,1803.76 1471.19,1810.79 1479.85,1816.65 1488.51,1822.08 1497.17,1827.48 1505.83,1832.68 1514.49,1837.31 1523.15,1841.38 
  1531.81,1845.29 1540.47,1849.42 1549.13,1853.78 1557.79,1858 1566.45,1861.71 1575.11,1864.84 1583.77,1867.56 1592.43,1870.03 1601.09,1872.28 1609.75,1874.2 
  1618.41,1875.69 1627.07,1876.75 1635.73,1877.46 1644.39,1877.9 1653.06,1878.16 1661.72,1878.37 1670.38,1878.67 1679.04,1879.17 1687.7,1879.9 1696.36,1880.75 
  1705.02,1881.57 1713.68,1882.22 1722.34,1882.62 1731,1882.75 1739.66,1882.67 1748.32,1882.49 1756.98,1882.3 1765.64,1882.19 1774.3,1882.23 1782.96,1882.39 
  1791.62,1882.64 1800.28,1882.91 1808.94,1883.14 1817.6,1883.31 1826.26,1883.42 1834.92,1883.48 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip8700)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip8700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip8700)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip8700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><p>Density of sigma</p><div><pre><code class="language-julia">density(samples[:sigma])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip8800">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip8800)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip8801">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip8800)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip8802">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  147.901,1937.01 147.901,47.2441 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  473.872,1937.01 473.872,47.2441 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  799.843,1937.01 799.843,47.2441 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1125.81,1937.01 1125.81,47.2441 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1451.78,1937.01 1451.78,47.2441 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1777.75,1937.01 1777.75,47.2441 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1559.26 1921.26,1559.26 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1235 1921.26,1235 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,910.738 1921.26,910.738 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,586.475 1921.26,586.475 
  "/>
<polyline clip-path="url(#clip8802)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,262.213 1921.26,262.213 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  147.901,1937.01 147.901,1908.66 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  473.872,1937.01 473.872,1908.66 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  799.843,1937.01 799.843,1908.66 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1125.81,1937.01 1125.81,1908.66 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1451.78,1937.01 1451.78,1908.66 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1777.75,1937.01 1777.75,1908.66 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1559.26 121.89,1559.26 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1235 121.89,1235 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,910.738 121.89,910.738 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,586.475 121.89,586.475 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,262.213 121.89,262.213 
  "/>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 147.901, 1989.01)" x="147.901" y="1989.01">6.5</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 473.872, 1989.01)" x="473.872" y="1989.01">7.0</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 799.843, 1989.01)" x="799.843" y="1989.01">7.5</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1125.81, 1989.01)" x="1125.81" y="1989.01">8.0</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1451.78, 1989.01)" x="1451.78" y="1989.01">8.5</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1777.75, 1989.01)" x="1777.75" y="1989.01">9.0</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.00</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1576.76)" x="74.4882" y="1576.76">0.25</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1252.5)" x="74.4882" y="1252.5">0.50</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 928.238)" x="74.4882" y="928.238">0.75</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 603.975)" x="74.4882" y="603.975">1.00</text>
</g>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 279.713)" x="74.4882" y="279.713">1.25</text>
</g>
<polyline clip-path="url(#clip8802)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.51 180.83,1883.49 189.49,1883.45 198.15,1883.37 206.81,1883.25 215.47,1883.08 224.131,1882.86 
  232.791,1882.62 241.451,1882.42 250.111,1882.31 258.771,1882.31 267.431,1882.42 276.091,1882.62 284.752,1882.85 293.412,1883.05 302.072,1883.19 310.732,1883.25 
  319.392,1883.21 328.052,1883.08 336.713,1882.86 345.373,1882.57 354.033,1882.21 362.693,1881.77 371.353,1881.17 380.013,1880.29 388.673,1878.96 397.334,1877 
  405.994,1874.31 414.654,1870.89 423.314,1866.87 431.974,1862.46 440.634,1857.86 449.294,1853.27 457.955,1848.81 466.615,1844.44 475.275,1840 483.935,1835.21 
  492.595,1829.68 501.255,1823.02 509.915,1814.89 518.576,1805.02 527.236,1793.17 535.896,1779.05 544.556,1762.37 553.216,1742.92 561.876,1720.73 570.537,1696.06 
  579.197,1669.42 587.857,1641.4 596.517,1612.55 605.177,1583.37 613.837,1554.4 622.497,1526.22 631.158,1499.29 639.818,1473.68 648.478,1448.83 657.138,1423.58 
  665.798,1396.45 674.458,1366.1 683.118,1331.76 691.779,1293.36 700.439,1251.31 709.099,1206.15 717.759,1158.24 726.419,1107.72 735.079,1054.82 743.739,1000.23 
  752.4,945.244 761.06,891.398 769.72,839.885 778.38,791.06 787.04,744.448 795.7,699.239 804.361,654.891 813.021,611.404 821.681,569.114 830.341,528.259 
  839.001,488.746 847.661,450.367 856.321,413.21 864.982,377.808 873.642,344.762 882.302,314.112 890.962,285.018 899.622,256.146 908.282,226.546 916.942,196.417 
  925.603,167.246 934.263,141.286 942.923,120.738 951.583,107.082 960.243,100.728 968.903,100.989 977.563,106.354 986.224,115.054 994.884,125.788 1003.54,138.312 
  1012.2,153.513 1020.86,172.86 1029.52,197.513 1038.18,227.596 1046.84,262.051 1055.5,299.096 1064.16,336.978 1072.83,374.633 1081.49,411.97 1090.15,449.733 
  1098.81,489.097 1107.47,531.15 1116.13,576.444 1124.79,624.744 1133.45,675.067 1142.11,726.029 1150.77,776.323 1159.43,825.074 1168.09,871.911 1176.75,916.778 
  1185.41,959.709 1194.07,1000.75 1202.73,1040.05 1211.39,1077.97 1220.05,1115.11 1228.71,1152.24 1237.37,1190.06 1246.03,1229.06 1254.69,1269.35 1263.35,1310.61 
  1272.01,1352.14 1280.67,1392.94 1289.33,1431.97 1297.99,1468.36 1306.65,1501.61 1315.31,1531.8 1323.97,1559.43 1332.63,1585.27 1341.29,1609.99 1349.95,1633.93 
  1358.61,1657.02 1367.27,1678.88 1375.93,1699.08 1384.59,1717.3 1393.25,1733.47 1401.91,1747.71 1410.57,1760.25 1419.23,1771.31 1427.89,1781.02 1436.55,1789.43 
  1445.21,1796.58 1453.87,1802.6 1462.53,1807.8 1471.19,1812.61 1479.85,1817.48 1488.51,1822.69 1497.17,1828.28 1505.83,1834.03 1514.49,1839.6 1523.15,1844.68 
  1531.81,1849.08 1540.47,1852.76 1549.13,1855.75 1557.79,1858.19 1566.45,1860.2 1575.11,1861.94 1583.77,1863.55 1592.43,1865.14 1601.09,1866.77 1609.75,1868.39 
  1618.41,1869.89 1627.07,1871.1 1635.73,1871.93 1644.39,1872.39 1653.06,1872.62 1661.72,1872.82 1670.38,1873.2 1679.04,1873.85 1687.7,1874.75 1696.36,1875.8 
  1705.02,1876.87 1713.68,1877.87 1722.34,1878.74 1731,1879.47 1739.66,1880.09 1748.32,1880.63 1756.98,1881.11 1765.64,1881.57 1774.3,1882 1782.96,1882.4 
  1791.62,1882.75 1800.28,1883.03 1808.94,1883.23 1817.6,1883.37 1826.26,1883.45 1834.92,1883.49 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip8800)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip8800)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip8800)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip8800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><h3><a class="nav-anchor" id="Snippet-4.20-1" href="#Snippet-4.20-1">Snippet 4.20</a></h3><p>Hdp mu</p><div><pre><code class="language-julia">MCMCChain.hpd(samples[:mu])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 153.86934673366835
 155.37688442211055</code></pre></div><p>Hdp sigma</p><div><pre><code class="language-julia">MCMCChain.hpd(samples[:sigma])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 7.21608040201005
 8.321608040201005</code></pre></div><p>End of <code>clip-14-20.jl</code></p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../clip-07-13s/"><span class="direction">Previous</span><span class="title">clip-07-13s</span></a><a class="next" href="../clip-21-23/"><span class="direction">Next</span><span class="title">clip-21-23</span></a></footer></article></body></html>
