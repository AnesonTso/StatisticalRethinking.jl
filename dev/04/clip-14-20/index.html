<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>clip-14-20 · StatisticalRethinking.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>StatisticalRethinking.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><a class="toctext" href="../../layout/">Layout</a></li><li><a class="toctext" href="../../versions/">Versions</a></li><li><a class="toctext" href="../../acknowledgements/">Acknowledgements</a></li><li><a class="toctext" href="../../references/">References</a></li><li><span class="toctext">Chapter 00</span><ul><li><a class="toctext" href="../../00/clip-01-03/">clip-01-03</a></li><li><a class="toctext" href="../../00/clip-04-05/">clip-04-05</a></li></ul></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/clip-01-02/">clip-01-02</a></li><li><a class="toctext" href="../../02/clip-03-05/">clip-03-05</a></li><li><a class="toctext" href="../../02/clip-06-07/">clip-06-07</a></li><li><a class="toctext" href="../../02/clip-08/">clip-08</a></li><li><a class="toctext" href="../../02/m2.1s/">m2.1s</a></li></ul></li><li><span class="toctext">Chapter 03</span><ul><li><a class="toctext" href="../../03/clip-01/">clip-01</a></li><li><a class="toctext" href="../../03/clip-02-05/">clip-02-05</a></li><li><a class="toctext" href="../../03/clip-05s/">clip-05s</a></li><li><a class="toctext" href="../../03/clip-06-10/">clip-06-10</a></li><li><a class="toctext" href="../../03/clip-11-16/">clip-11-16</a></li><li><a class="toctext" href="../../03/clip-17s/">clip-17s</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../m4.1s/">m4.1s</a></li><li><a class="toctext" href="../clip-01-06/">clip-01-06</a></li><li><a class="toctext" href="../clip-07-13s/">clip-07-13s</a></li><li class="current"><a class="toctext" href>clip-14-20</a><ul class="internal"></ul></li><li><a class="toctext" href="../clip-21-23/">clip-21-23</a></li><li><a class="toctext" href="../clip-24-29s/">clip-24-29s</a></li><li><a class="toctext" href="../clip-30s/">clip-30s</a></li><li><a class="toctext" href="../clip-38s/">clip-38s</a></li><li><a class="toctext" href="../clip-43s/">clip-43s</a></li><li><a class="toctext" href="../clip-45-47s/">clip-45-47s</a></li><li><a class="toctext" href="../clip-48-54s/">clip-48-54s</a></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 04</li><li><a href>clip-14-20</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/StatisticalRethinking.jl/blob/master/scripts/04/clip-14-20.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>clip-14-20</span><a class="fa fa-bars" href="#"></a></div></header><p>Load Julia packages (libraries) needed  for the snippets in chapter 0</p><pre><code class="language-julia">using StatisticalRethinking, CmdStan
gr(size=(500,500));</code></pre><pre><code class="language-none">Plots.GRBackend()</code></pre><p>CmdStan uses a tmp directory to store the output of cmdstan</p><pre><code class="language-julia">ProjDir = rel_path(&quot;..&quot;, &quot;scripts&quot;, &quot;04&quot;)
cd(ProjDir)</code></pre><h3><a class="nav-anchor" id="snippet-4.7-1" href="#snippet-4.7-1">snippet 4.7</a></h3><pre><code class="language-julia">howell1 = CSV.read(rel_path(&quot;..&quot;, &quot;data&quot;, &quot;Howell1.csv&quot;), delim=&#39;;&#39;)
df = convert(DataFrame, howell1);</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>544 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr><tr><th>6</th><td>163.83</td><td>62.9926</td><td>35.0</td><td>1</td></tr><tr><th>7</th><td>149.225</td><td>38.2435</td><td>32.0</td><td>0</td></tr><tr><th>8</th><td>168.91</td><td>55.48</td><td>27.0</td><td>1</td></tr><tr><th>9</th><td>147.955</td><td>34.8699</td><td>19.0</td><td>0</td></tr><tr><th>10</th><td>165.1</td><td>54.4877</td><td>54.0</td><td>1</td></tr><tr><th>11</th><td>154.305</td><td>49.8951</td><td>47.0</td><td>0</td></tr><tr><th>12</th><td>151.13</td><td>41.2202</td><td>66.0</td><td>1</td></tr><tr><th>13</th><td>144.78</td><td>36.0322</td><td>73.0</td><td>0</td></tr><tr><th>14</th><td>149.9</td><td>47.7</td><td>20.0</td><td>0</td></tr><tr><th>15</th><td>150.495</td><td>33.8493</td><td>65.3</td><td>0</td></tr><tr><th>16</th><td>163.195</td><td>48.5627</td><td>36.0</td><td>1</td></tr><tr><th>17</th><td>157.48</td><td>42.3258</td><td>44.0</td><td>1</td></tr><tr><th>18</th><td>143.942</td><td>38.3569</td><td>31.0</td><td>0</td></tr><tr><th>19</th><td>121.92</td><td>19.6179</td><td>12.0</td><td>1</td></tr><tr><th>20</th><td>105.41</td><td>13.948</td><td>8.0</td><td>0</td></tr><tr><th>21</th><td>86.36</td><td>10.4893</td><td>6.5</td><td>0</td></tr><tr><th>22</th><td>161.29</td><td>48.9879</td><td>39.0</td><td>1</td></tr><tr><th>23</th><td>156.21</td><td>42.7227</td><td>29.0</td><td>0</td></tr><tr><th>24</th><td>129.54</td><td>23.5868</td><td>13.0</td><td>1</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table><h3><a class="nav-anchor" id="snippet-4.8-1" href="#snippet-4.8-1">snippet 4.8</a></h3><p>Use only adults</p><pre><code class="language-julia">df2 = filter(row -&gt; row[:age] &gt;= 18, df);</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>352 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr><tr><th>6</th><td>163.83</td><td>62.9926</td><td>35.0</td><td>1</td></tr><tr><th>7</th><td>149.225</td><td>38.2435</td><td>32.0</td><td>0</td></tr><tr><th>8</th><td>168.91</td><td>55.48</td><td>27.0</td><td>1</td></tr><tr><th>9</th><td>147.955</td><td>34.8699</td><td>19.0</td><td>0</td></tr><tr><th>10</th><td>165.1</td><td>54.4877</td><td>54.0</td><td>1</td></tr><tr><th>11</th><td>154.305</td><td>49.8951</td><td>47.0</td><td>0</td></tr><tr><th>12</th><td>151.13</td><td>41.2202</td><td>66.0</td><td>1</td></tr><tr><th>13</th><td>144.78</td><td>36.0322</td><td>73.0</td><td>0</td></tr><tr><th>14</th><td>149.9</td><td>47.7</td><td>20.0</td><td>0</td></tr><tr><th>15</th><td>150.495</td><td>33.8493</td><td>65.3</td><td>0</td></tr><tr><th>16</th><td>163.195</td><td>48.5627</td><td>36.0</td><td>1</td></tr><tr><th>17</th><td>157.48</td><td>42.3258</td><td>44.0</td><td>1</td></tr><tr><th>18</th><td>143.942</td><td>38.3569</td><td>31.0</td><td>0</td></tr><tr><th>19</th><td>161.29</td><td>48.9879</td><td>39.0</td><td>1</td></tr><tr><th>20</th><td>156.21</td><td>42.7227</td><td>29.0</td><td>0</td></tr><tr><th>21</th><td>146.4</td><td>35.4936</td><td>56.0</td><td>1</td></tr><tr><th>22</th><td>148.59</td><td>37.9033</td><td>45.0</td><td>0</td></tr><tr><th>23</th><td>147.32</td><td>35.4652</td><td>19.0</td><td>0</td></tr><tr><th>24</th><td>147.955</td><td>40.313</td><td>29.0</td><td>1</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table><p>Show first 5 rows of DataFrame df</p><pre><code class="language-julia">first(df2, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>5 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr></tbody></table><h3><a class="nav-anchor" id="Snippet-4.14-1" href="#Snippet-4.14-1">Snippet 4.14</a></h3><p>Generate approximate probabilities</p><pre><code class="language-julia">struct Post
  mu::Float64
  sigma::Float64
  ll:: Float64
  prod::Float64
  prob::Float64
end

mu_list = repeat(range(140, 160, length=200), 200);
sigma_list = repeat(range(4, 9, length=200), inner=200);

ll = zeros(40000);
for i in 1:40000
    d1 = Normal(mu_list[i], sigma_list[i])
    ll[i] = sum(log.(pdf.(d1, df2[:height])))
end

d2 = Normal(178.0, 20.0)
d3 = Uniform(0, 50)
prod = ll + log.(pdf.(d2, mu_list)) + log.(pdf.(d3, sigma_list))
prob = exp.(prod .- maximum(prod))
post = DataFrame(mu=mu_list, sigma=sigma_list, ll=ll, prod=prod, prob=prob)
first(post, 10)</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10 rows × 5 columns</p><tr><th>1</th><td>140.0</td><td>4.0</td><td>-3812.78</td><td>-3822.41</td><td>0.0</td></tr><tr><th>2</th><td>140.101</td><td>4.0</td><td>-3780.61</td><td>-3790.23</td><td>0.0</td></tr><tr><th>3</th><td>140.201</td><td>4.0</td><td>-3748.67</td><td>-3758.28</td><td>0.0</td></tr><tr><th>4</th><td>140.302</td><td>4.0</td><td>-3716.95</td><td>-3726.55</td><td>0.0</td></tr><tr><th>5</th><td>140.402</td><td>4.0</td><td>-3685.45</td><td>-3695.05</td><td>0.0</td></tr><tr><th>6</th><td>140.503</td><td>4.0</td><td>-3654.18</td><td>-3663.76</td><td>0.0</td></tr><tr><th>7</th><td>140.603</td><td>4.0</td><td>-3623.13</td><td>-3632.7</td><td>0.0</td></tr><tr><th>8</th><td>140.704</td><td>4.0</td><td>-3592.3</td><td>-3601.86</td><td>0.0</td></tr><tr><th>9</th><td>140.804</td><td>4.0</td><td>-3561.69</td><td>-3571.24</td><td>0.0</td></tr><tr><th>10</th><td>140.905</td><td>4.0</td><td>-3531.3</td><td>-3540.85</td><td>0.0</td></tr></tbody></table><h3><a class="nav-anchor" id="Snippet-4.15-1" href="#Snippet-4.15-1">Snippet 4.15</a></h3><p>Sample post</p><pre><code class="language-julia">samples = post[sample(1:size(post, 1), Weights(post[:prob]), 10000, replace=true), :]</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10,000 rows × 5 columns</p><tr><th>1</th><td>154.573</td><td>7.76884</td><td>-1219.42</td><td>-1227.93</td><td>0.992717</td></tr><tr><th>2</th><td>154.874</td><td>8.49749</td><td>-1222.55</td><td>-1231.04</td><td>0.0441108</td></tr><tr><th>3</th><td>154.673</td><td>7.79397</td><td>-1219.44</td><td>-1227.95</td><td>0.969323</td></tr><tr><th>4</th><td>154.673</td><td>8.37186</td><td>-1221.54</td><td>-1230.04</td><td>0.119742</td></tr><tr><th>5</th><td>154.874</td><td>7.94472</td><td>-1219.88</td><td>-1228.37</td><td>0.637315</td></tr><tr><th>6</th><td>154.573</td><td>7.54271</td><td>-1219.63</td><td>-1228.14</td><td>0.804531</td></tr><tr><th>7</th><td>154.874</td><td>8.22111</td><td>-1220.88</td><td>-1229.38</td><td>0.233316</td></tr><tr><th>8</th><td>155.075</td><td>7.94472</td><td>-1220.3</td><td>-1228.78</td><td>0.422147</td></tr><tr><th>9</th><td>154.07</td><td>7.86935</td><td>-1220.3</td><td>-1228.85</td><td>0.396692</td></tr><tr><th>10</th><td>154.271</td><td>8.17085</td><td>-1220.72</td><td>-1229.25</td><td>0.263834</td></tr><tr><th>11</th><td>154.774</td><td>7.9196</td><td>-1219.69</td><td>-1228.19</td><td>0.760422</td></tr><tr><th>12</th><td>155.477</td><td>7.94472</td><td>-1221.82</td><td>-1230.28</td><td>0.0941862</td></tr><tr><th>13</th><td>155.276</td><td>8.39698</td><td>-1222.83</td><td>-1231.3</td><td>0.0339516</td></tr><tr><th>14</th><td>154.472</td><td>7.59296</td><td>-1219.57</td><td>-1228.09</td><td>0.846241</td></tr><tr><th>15</th><td>154.573</td><td>8.34673</td><td>-1221.37</td><td>-1229.88</td><td>0.140552</td></tr><tr><th>16</th><td>153.97</td><td>7.44221</td><td>-1221.18</td><td>-1229.73</td><td>0.163999</td></tr><tr><th>17</th><td>154.372</td><td>7.59296</td><td>-1219.68</td><td>-1228.2</td><td>0.755597</td></tr><tr><th>18</th><td>154.874</td><td>7.41709</td><td>-1220.27</td><td>-1228.77</td><td>0.427849</td></tr><tr><th>19</th><td>154.271</td><td>7.71859</td><td>-1219.72</td><td>-1228.25</td><td>0.719244</td></tr><tr><th>20</th><td>154.07</td><td>7.51759</td><td>-1220.55</td><td>-1229.09</td><td>0.309407</td></tr><tr><th>21</th><td>154.774</td><td>7.86935</td><td>-1219.6</td><td>-1228.1</td><td>0.832443</td></tr><tr><th>22</th><td>154.07</td><td>7.8191</td><td>-1220.25</td><td>-1228.79</td><td>0.418801</td></tr><tr><th>23</th><td>154.774</td><td>8.54774</td><td>-1222.8</td><td>-1231.3</td><td>0.0339715</td></tr><tr><th>24</th><td>154.271</td><td>7.46734</td><td>-1220.17</td><td>-1228.71</td><td>0.456153</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table><h3><a class="nav-anchor" id="Snippet-4.19-1" href="#Snippet-4.19-1">Snippet 4.19</a></h3><p>Density of mu</p><pre><code class="language-julia">density(samples[:mu])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip2300">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2300)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2301">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2300)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2302">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  218.479,1937.01 218.479,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  704.825,1937.01 704.825,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1191.17,1937.01 1191.17,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1677.52,1937.01 1677.52,47.2441 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1513.7 1921.26,1513.7 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1143.88 1921.26,1143.88 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,774.054 1921.26,774.054 
  "/>
<polyline clip-path="url(#clip2302)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,404.231 1921.26,404.231 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  218.479,1937.01 218.479,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  704.825,1937.01 704.825,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1191.17,1937.01 1191.17,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1677.52,1937.01 1677.52,1908.66 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1513.7 121.89,1513.7 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1143.88 121.89,1143.88 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,774.054 121.89,774.054 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,404.231 121.89,404.231 
  "/>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 218.479, 1989.01)" x="218.479" y="1989.01">153</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 704.825, 1989.01)" x="704.825" y="1989.01">154</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1191.17, 1989.01)" x="1191.17" y="1989.01">155</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1677.52, 1989.01)" x="1677.52" y="1989.01">156</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.0</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1531.2)" x="74.4882" y="1531.2">0.2</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1161.38)" x="74.4882" y="1161.38">0.4</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 791.554)" x="74.4882" y="791.554">0.6</text>
</g>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 421.731)" x="74.4882" y="421.731">0.8</text>
</g>
<polyline clip-path="url(#clip2302)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.51 172.17,1883.49 180.83,1883.45 189.49,1883.34 198.15,1883.15 206.81,1882.84 215.47,1882.39 224.131,1881.83 
  232.791,1881.27 241.451,1880.8 250.111,1880.52 258.771,1880.46 267.431,1880.56 276.091,1880.69 284.752,1880.68 293.412,1880.38 302.072,1879.68 310.732,1878.52 
  319.392,1876.91 328.052,1874.99 336.713,1872.96 345.373,1870.97 354.033,1868.99 362.693,1866.87 371.353,1864.43 380.013,1861.64 388.673,1858.64 397.334,1855.52 
  405.994,1852.19 414.654,1848.42 423.314,1844.14 431.974,1839.67 440.634,1835.59 449.294,1832.27 457.955,1829.53 466.615,1826.74 475.275,1823.3 483.935,1818.95 
  492.595,1813.61 501.255,1807.02 509.915,1798.58 518.576,1787.94 527.236,1775.53 535.896,1762.45 544.556,1749.54 553.216,1736.48 561.876,1722.01 570.537,1705.16 
  579.197,1686.26 587.857,1666.44 596.517,1646 605.177,1623.61 613.837,1597.34 622.497,1566.97 631.158,1534.72 639.818,1503.23 648.478,1472.58 657.138,1439.7 
  665.798,1401.4 674.458,1358.22 683.118,1314.74 691.779,1275.46 700.439,1240.21 709.099,1204.34 717.759,1163.97 726.419,1120.81 735.079,1081.1 743.739,1048.99 
  752.4,1021.68 761.06,991.772 769.72,955.008 778.38,914.952 787.04,879.095 795.7,850.165 804.361,822.212 813.021,786.248 821.681,739.661 830.341,688.976 
  839.001,642.559 847.661,601.208 856.321,557.481 864.982,505.094 873.642,448.016 882.302,398.364 890.962,364.309 899.622,340.958 908.282,314.945 916.942,278.741 
  925.603,239.44 934.263,211.943 942.923,203.212 951.583,204.393 960.243,199.487 968.903,181.386 977.563,158.069 986.224,142.619 994.884,138.47 1003.54,136.348 
  1012.2,126.082 1020.86,109.709 1029.52,100.728 1038.18,109.876 1046.84,133.113 1055.5,155.465 1064.16,167.022 1072.83,173.89 1081.49,192.124 1090.15,231.037 
  1098.81,283.597 1107.47,333.731 1116.13,372.211 1124.79,404.276 1133.45,441.841 1142.11,489.831 1150.77,541.507 1159.43,586.861 1168.09,623.816 1176.75,659.799 
  1185.41,702.645 1194.07,751.549 1202.73,798.176 1211.39,836.352 1220.05,869.453 1228.71,907.486 1237.37,957.168 1246.03,1015.52 1254.69,1073.2 1263.35,1123.32 
  1272.01,1166.63 1280.67,1208.46 1289.33,1251.94 1297.99,1295 1306.65,1333.53 1315.31,1366.46 1323.97,1396.92 1332.63,1428.71 1341.29,1462.29 1349.95,1494.65 
  1358.61,1522.87 1367.27,1547.23 1375.93,1570.77 1384.59,1596.06 1393.25,1622.82 1401.91,1648.46 1410.57,1670.74 1419.23,1689.49 1427.89,1706.08 1436.55,1721.6 
  1445.21,1735.94 1453.87,1748.46 1462.53,1759.23 1471.19,1769.32 1479.85,1779.87 1488.51,1791.09 1497.17,1802.13 1505.83,1811.91 1514.49,1820.01 1523.15,1826.76 
  1531.81,1832.7 1540.47,1838.05 1549.13,1842.7 1557.79,1846.58 1566.45,1849.89 1575.11,1852.96 1583.77,1855.99 1592.43,1858.89 1601.09,1861.46 1609.75,1863.61 
  1618.41,1865.41 1627.07,1867.03 1635.73,1868.54 1644.39,1869.88 1653.06,1871.05 1661.72,1872.14 1670.38,1873.31 1679.04,1874.69 1687.7,1876.24 1696.36,1877.79 
  1705.02,1879.14 1713.68,1880.18 1722.34,1880.89 1731,1881.32 1739.66,1881.56 1748.32,1881.68 1756.98,1881.77 1765.64,1881.9 1774.3,1882.1 1782.96,1882.37 
  1791.62,1882.67 1800.28,1882.95 1808.94,1883.18 1817.6,1883.34 1826.26,1883.43 1834.92,1883.49 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip2300)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip2300)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip2300)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip2300)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
<p>Density of sigma</p><pre><code class="language-julia">density(samples[:sigma])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip2900">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2900)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2901">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2900)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2902">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  413.446,1937.01 413.446,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  765.503,1937.01 765.503,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1117.56,1937.01 1117.56,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1469.62,1937.01 1469.62,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1821.67,1937.01 1821.67,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1620.69 1921.26,1620.69 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1357.85 1921.26,1357.85 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1095.01 1921.26,1095.01 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,832.169 1921.26,832.169 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,569.33 1921.26,569.33 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,306.491 1921.26,306.491 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  413.446,1937.01 413.446,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  765.503,1937.01 765.503,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1117.56,1937.01 1117.56,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1469.62,1937.01 1469.62,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1821.67,1937.01 1821.67,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1620.69 121.89,1620.69 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1357.85 121.89,1357.85 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1095.01 121.89,1095.01 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,832.169 121.89,832.169 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,569.33 121.89,569.33 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,306.491 121.89,306.491 
  "/>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 413.446, 1989.01)" x="413.446" y="1989.01">7.0</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 765.503, 1989.01)" x="765.503" y="1989.01">7.5</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1117.56, 1989.01)" x="1117.56" y="1989.01">8.0</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1469.62, 1989.01)" x="1469.62" y="1989.01">8.5</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1821.67, 1989.01)" x="1821.67" y="1989.01">9.0</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.0</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1638.19)" x="74.4882" y="1638.19">0.2</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1375.35)" x="74.4882" y="1375.35">0.4</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1112.51)" x="74.4882" y="1112.51">0.6</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 849.669)" x="74.4882" y="849.669">0.8</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 586.83)" x="74.4882" y="586.83">1.0</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 323.991)" x="74.4882" y="323.991">1.2</text>
</g>
<polyline clip-path="url(#clip2902)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.51 180.83,1883.5 189.49,1883.47 198.15,1883.41 206.81,1883.32 215.47,1883.16 224.131,1882.93 
  232.791,1882.62 241.451,1882.22 250.111,1881.73 258.771,1881.16 267.431,1880.51 276.091,1879.75 284.752,1878.85 293.412,1877.78 302.072,1876.48 310.732,1874.94 
  319.392,1873.15 328.052,1871.13 336.713,1868.95 345.373,1866.68 354.033,1864.38 362.693,1862.11 371.353,1859.9 380.013,1857.74 388.673,1855.58 397.334,1853.3 
  405.994,1850.72 414.654,1847.53 423.314,1843.4 431.974,1837.95 440.634,1830.89 449.294,1822.04 457.955,1811.39 466.615,1799.02 475.275,1785.08 483.935,1769.62 
  492.595,1752.62 501.255,1734.09 509.915,1714.21 518.576,1693.49 527.236,1672.72 535.896,1652.68 544.556,1633.82 553.216,1615.9 561.876,1598.01 570.537,1578.72 
  579.197,1556.51 587.857,1530.18 596.517,1499.02 605.177,1462.95 613.837,1422.36 622.497,1378 631.158,1330.89 639.818,1282.15 648.478,1233 657.138,1184.67 
  665.798,1138.34 674.458,1095 683.118,1055.2 691.779,1018.89 700.439,985.285 709.099,952.964 717.759,920.232 726.419,885.505 735.079,847.608 743.739,805.868 
  752.4,760.064 761.06,710.359 769.72,657.311 778.38,601.91 787.04,545.533 795.7,489.8 804.361,436.374 813.021,386.835 821.681,342.637 830.341,305.04 
  839.001,274.887 847.661,252.246 856.321,236.09 864.982,224.29 873.642,214.061 882.302,202.744 890.962,188.637 899.622,171.491 908.282,152.515 916.942,133.881 
  925.603,117.982 934.263,106.707 942.923,100.99 951.583,100.728 960.243,105.082 968.903,112.996 977.563,123.718 986.224,137.101 994.884,153.597 1003.54,174.003 
  1012.2,199.136 1020.86,229.54 1029.52,265.264 1038.18,305.706 1046.84,349.549 1055.5,394.886 1064.16,439.591 1072.83,481.863 1081.49,520.735 1090.15,556.325 
  1098.81,589.727 1107.47,622.573 1116.13,656.459 1124.79,692.452 1133.45,730.869 1142.11,771.384 1150.77,813.35 1159.43,856.147 1168.09,899.375 1176.75,942.806 
  1185.41,986.204 1194.07,1029.13 1202.73,1070.92 1211.39,1110.75 1220.05,1147.87 1228.71,1181.83 1237.37,1212.6 1246.03,1240.59 1254.69,1266.58 1263.35,1291.58 
  1272.01,1316.65 1280.67,1342.72 1289.33,1370.38 1297.99,1399.71 1306.65,1430.25 1315.31,1461.04 1323.97,1490.91 1332.63,1518.79 1341.29,1544.06 1349.95,1566.67 
  1358.61,1587.1 1367.27,1606.09 1375.93,1624.4 1384.59,1642.54 1393.25,1660.67 1401.91,1678.61 1410.57,1695.99 1419.23,1712.35 1427.89,1727.31 1436.55,1740.66 
  1445.21,1752.41 1453.87,1762.77 1462.53,1772.07 1471.19,1780.66 1479.85,1788.77 1488.51,1796.5 1497.17,1803.79 1505.83,1810.48 1514.49,1816.43 1523.15,1821.62 
  1531.81,1826.15 1540.47,1830.24 1549.13,1834.16 1557.79,1838.15 1566.45,1842.37 1575.11,1846.81 1583.77,1851.38 1592.43,1855.87 1601.09,1860.02 1609.75,1863.62 
  1618.41,1866.55 1627.07,1868.8 1635.73,1870.44 1644.39,1871.59 1653.06,1872.38 1661.72,1872.89 1670.38,1873.18 1679.04,1873.29 1687.7,1873.29 1696.36,1873.25 
  1705.02,1873.27 1713.68,1873.46 1722.34,1873.89 1731,1874.62 1739.66,1875.64 1748.32,1876.88 1756.98,1878.23 1765.64,1879.54 1774.3,1880.71 1782.96,1881.66 
  1791.62,1882.37 1800.28,1882.86 1808.94,1883.16 1817.6,1883.34 1826.26,1883.44 1834.92,1883.49 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip2900)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
<h3><a class="nav-anchor" id="Snippet-4.20-1" href="#Snippet-4.20-1">Snippet 4.20</a></h3><p>Hdp mu</p><pre><code class="language-julia">#hpd(samples[:mu])</code></pre><p>Hdp sigma</p><pre><code class="language-julia">#hpd(samples[:sigma])</code></pre><p>End of <code>clip-14-20.jl</code></p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../clip-07-13s/"><span class="direction">Previous</span><span class="title">clip-07-13s</span></a><a class="next" href="../clip-21-23/"><span class="direction">Next</span><span class="title">clip-21-23</span></a></footer></article></body></html>
