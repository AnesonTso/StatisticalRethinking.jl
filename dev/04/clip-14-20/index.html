<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>clip-14-20 · StatisticalRethinking.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>StatisticalRethinking.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><a class="toctext" href="../../layout/">Layout</a></li><li><a class="toctext" href="../../versions/">Versions</a></li><li><a class="toctext" href="../../notes/">Notes</a></li><li><a class="toctext" href="../../acknowledgements/">Acknowledgements</a></li><li><a class="toctext" href="../../references/">References</a></li><li><span class="toctext">Chapter 00</span><ul><li><a class="toctext" href="../../00/clip-01-03/">clip-01-03</a></li><li><a class="toctext" href="../../00/clip-04-05/">clip-04-05</a></li></ul></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/clip-01-02/">clip-01-02</a></li><li><a class="toctext" href="../../02/clip-03-05/">clip-03-05</a></li><li><a class="toctext" href="../../02/clip-06-07/">clip-06-07</a></li><li><a class="toctext" href="../../02/clip-08d/">clip-08d</a></li><li><a class="toctext" href="../../02/clip-08s/">clip-08s</a></li><li><a class="toctext" href="../../02/clip-08t/">clip-08t</a></li></ul></li><li><span class="toctext">Chapter 03</span><ul><li><a class="toctext" href="../../03/clip-01/">clip-01</a></li><li><a class="toctext" href="../../03/clip-02-05/">clip-02-05</a></li><li><a class="toctext" href="../../03/clip-05s/">clip-05s</a></li><li><a class="toctext" href="../../03/clip-06-16s/">clip-06-16s</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../m4.1d/">m4.1d</a></li><li><a class="toctext" href="../m4.1s/">m4.1s</a></li><li><a class="toctext" href="../m4.2t/">m4.2t</a></li><li><a class="toctext" href="../m4.5d/">m4.5d</a></li><li><a class="toctext" href="../m4.5s/">m4.5s</a></li><li><a class="toctext" href="../clip-01-06/">clip-01-06</a></li><li><a class="toctext" href="../clip-07-13s/">clip-07-13s</a></li><li class="current"><a class="toctext" href>clip-14-20</a><ul class="internal"></ul></li><li><a class="toctext" href="../clip-21-23/">clip-21-23</a></li><li><a class="toctext" href="../clip-24-29s/">clip-24-29s</a></li><li><a class="toctext" href="../clip-30s/">clip-30s</a></li><li><a class="toctext" href="../clip-38s/">clip-38s</a></li><li><a class="toctext" href="../clip-43s/">clip-43s</a></li><li><a class="toctext" href="../clip-45-47s/">clip-45-47s</a></li><li><a class="toctext" href="../clip-48-54s/">clip-48-54s</a></li></ul></li><li><span class="toctext">Chapter 05</span><ul><li><a class="toctext" href="../../05/m5.1d/">m5.1d</a></li><li><a class="toctext" href="../../05/m5.1s/">m5.1s</a></li><li><a class="toctext" href="../../05/m5.6d/">m5.6d</a></li><li><a class="toctext" href="../../05/m5.6s/">m5.6s</a></li></ul></li><li><span class="toctext">Chapter 08</span><ul><li><a class="toctext" href="../../08/m8.1d/">m8.1d</a></li><li><a class="toctext" href="../../08/m8.1s/">m8.1s</a></li><li><a class="toctext" href="../../08/m8.1t/">m8.1t</a></li><li><a class="toctext" href="../../08/m8.3t/">m8.3t</a></li><li><a class="toctext" href="../../08/m8.5s/">m8.5s</a></li><li><a class="toctext" href="../../08/m8.8s/">m8.8s</a></li></ul></li><li><span class="toctext">Chapter 10</span></li><li><span class="toctext">Chapter 11</span></li><li><span class="toctext">Chapter 12</span><ul><li><a class="toctext" href="../../12/m12.6.1s/">m12.6.1s</a></li><li><a class="toctext" href="../../12/m12.6.2s/">m12.6.2s</a></li></ul></li><li><span class="toctext">Chapter 13</span><ul><li><a class="toctext" href="../../13/m13.2s/">m13.2s</a></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 04</li><li><a href>clip-14-20</a></li></ul><a class="edit-page" href="https://github.com/StanJulia/StatisticalRethinking.jl/blob/master/scripts/04/clip-14-20.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>clip-14-20</span><a class="fa fa-bars" href="#"></a></div></header><p>Load Julia packages (libraries) needed  for the snippets in chapter 0</p><div><pre><code class="language-julia">using StatisticalRethinking, CmdStan, StanMCMCChain
gr(size=(500,500));</code></pre></div><p>CmdStan uses a tmp directory to store the output of cmdstan</p><div><pre><code class="language-julia">ProjDir = rel_path(&quot;..&quot;, &quot;scripts&quot;, &quot;04&quot;)
cd(ProjDir)</code></pre></div><h3><a class="nav-anchor" id="snippet-4.7-1" href="#snippet-4.7-1">snippet 4.7</a></h3><div><pre><code class="language-julia">howell1 = CSV.read(rel_path(&quot;..&quot;, &quot;data&quot;, &quot;Howell1.csv&quot;), delim=&#39;;&#39;)
df = convert(DataFrame, howell1);</code></pre></div><h3><a class="nav-anchor" id="snippet-4.8-1" href="#snippet-4.8-1">snippet 4.8</a></h3><p>Use only adults</p><div><pre><code class="language-julia">df2 = filter(row -&gt; row[:age] &gt;= 18, df);</code></pre></div><p>Show first 5 rows of DataFrame df</p><div><pre><code class="language-julia">first(df2, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>5 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.14-1" href="#Snippet-4.14-1">Snippet 4.14</a></h3><p>Generate approximate probabilities</p><div><pre><code class="language-julia">struct Post
  mu::Float64
  sigma::Float64
  ll:: Float64
  prod::Float64
  prob::Float64
end

mu_list = repeat(range(140, 160, length=200), 200);
sigma_list = repeat(range(4, 9, length=200), inner=200);

ll = zeros(40000);
for i in 1:40000
    d1 = Normal(mu_list[i], sigma_list[i])
    ll[i] = sum(log.(pdf.(d1, df2[:height])))
end

d2 = Normal(178.0, 20.0)
d3 = Uniform(0, 50)
prod = ll + log.(pdf.(d2, mu_list)) + log.(pdf.(d3, sigma_list))
prob = exp.(prod .- maximum(prod))
post = DataFrame(mu=mu_list, sigma=sigma_list, ll=ll, prod=prod, prob=prob)
first(post, 10)</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10 rows × 5 columns</p><tr><th>1</th><td>140.0</td><td>4.0</td><td>-3812.78</td><td>-3822.41</td><td>0.0</td></tr><tr><th>2</th><td>140.101</td><td>4.0</td><td>-3780.61</td><td>-3790.23</td><td>0.0</td></tr><tr><th>3</th><td>140.201</td><td>4.0</td><td>-3748.67</td><td>-3758.28</td><td>0.0</td></tr><tr><th>4</th><td>140.302</td><td>4.0</td><td>-3716.95</td><td>-3726.55</td><td>0.0</td></tr><tr><th>5</th><td>140.402</td><td>4.0</td><td>-3685.45</td><td>-3695.05</td><td>0.0</td></tr><tr><th>6</th><td>140.503</td><td>4.0</td><td>-3654.18</td><td>-3663.76</td><td>0.0</td></tr><tr><th>7</th><td>140.603</td><td>4.0</td><td>-3623.13</td><td>-3632.7</td><td>0.0</td></tr><tr><th>8</th><td>140.704</td><td>4.0</td><td>-3592.3</td><td>-3601.86</td><td>0.0</td></tr><tr><th>9</th><td>140.804</td><td>4.0</td><td>-3561.69</td><td>-3571.24</td><td>0.0</td></tr><tr><th>10</th><td>140.905</td><td>4.0</td><td>-3531.3</td><td>-3540.85</td><td>0.0</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.15-1" href="#Snippet-4.15-1">Snippet 4.15</a></h3><p>Sample post</p><div><pre><code class="language-julia">samples = post[sample(1:size(post, 1), Weights(post[:prob]), 10000, replace=true), :]</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10,000 rows × 5 columns</p><tr><th>1</th><td>154.774</td><td>7.74372</td><td>-1219.5</td><td>-1228.0</td><td>0.92471</td></tr><tr><th>2</th><td>154.673</td><td>7.84422</td><td>-1219.49</td><td>-1228.0</td><td>0.921819</td></tr><tr><th>3</th><td>154.774</td><td>7.66834</td><td>-1219.52</td><td>-1228.02</td><td>0.902246</td></tr><tr><th>4</th><td>154.975</td><td>7.49246</td><td>-1220.21</td><td>-1228.7</td><td>0.460458</td></tr><tr><th>5</th><td>154.774</td><td>7.46734</td><td>-1219.94</td><td>-1228.44</td><td>0.595014</td></tr><tr><th>6</th><td>154.774</td><td>7.49246</td><td>-1219.86</td><td>-1228.36</td><td>0.645533</td></tr><tr><th>7</th><td>155.176</td><td>7.89447</td><td>-1220.5</td><td>-1228.98</td><td>0.346483</td></tr><tr><th>8</th><td>154.673</td><td>8.0201</td><td>-1219.88</td><td>-1228.39</td><td>0.625377</td></tr><tr><th>9</th><td>154.573</td><td>8.34673</td><td>-1221.37</td><td>-1229.88</td><td>0.140552</td></tr><tr><th>10</th><td>154.673</td><td>7.84422</td><td>-1219.49</td><td>-1228.0</td><td>0.921819</td></tr><tr><th>11</th><td>154.372</td><td>8.07035</td><td>-1220.17</td><td>-1228.7</td><td>0.460035</td></tr><tr><th>12</th><td>154.975</td><td>7.16583</td><td>-1222.03</td><td>-1230.52</td><td>0.0742064</td></tr><tr><th>13</th><td>154.372</td><td>8.42211</td><td>-1221.97</td><td>-1230.49</td><td>0.0763753</td></tr><tr><th>14</th><td>154.573</td><td>7.84422</td><td>-1219.48</td><td>-1227.99</td><td>0.930235</td></tr><tr><th>15</th><td>155.276</td><td>8.22111</td><td>-1221.88</td><td>-1230.35</td><td>0.0877104</td></tr><tr><th>16</th><td>154.07</td><td>7.61809</td><td>-1220.32</td><td>-1228.87</td><td>0.388316</td></tr><tr><th>17</th><td>154.673</td><td>8.17085</td><td>-1220.46</td><td>-1228.96</td><td>0.351897</td></tr><tr><th>18</th><td>154.271</td><td>7.79397</td><td>-1219.74</td><td>-1228.27</td><td>0.707963</td></tr><tr><th>19</th><td>154.975</td><td>7.49246</td><td>-1220.21</td><td>-1228.7</td><td>0.460458</td></tr><tr><th>20</th><td>155.477</td><td>7.64322</td><td>-1221.79</td><td>-1230.25</td><td>0.097623</td></tr><tr><th>21</th><td>155.779</td><td>7.64322</td><td>-1223.66</td><td>-1232.1</td><td>0.0152541</td></tr><tr><th>22</th><td>154.271</td><td>7.76884</td><td>-1219.72</td><td>-1228.25</td><td>0.71693</td></tr><tr><th>23</th><td>154.975</td><td>8.24623</td><td>-1221.18</td><td>-1229.67</td><td>0.174504</td></tr><tr><th>24</th><td>155.075</td><td>7.34171</td><td>-1221.13</td><td>-1229.61</td><td>0.184577</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table></div><h3><a class="nav-anchor" id="Snippet-4.19-1" href="#Snippet-4.19-1">Snippet 4.19</a></h3><p>Density of mu</p><div><pre><code class="language-julia">density(samples[:mu])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip2900">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2900)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2901">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2900)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip2902">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  168.955,1937.01 168.955,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  641.887,1937.01 641.887,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1114.82,1937.01 1114.82,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1587.75,1937.01 1587.75,47.2441 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1505.51 1921.26,1505.51 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1127.5 1921.26,1127.5 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,749.482 1921.26,749.482 
  "/>
<polyline clip-path="url(#clip2902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,371.468 1921.26,371.468 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  168.955,1937.01 168.955,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  641.887,1937.01 641.887,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1114.82,1937.01 1114.82,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1587.75,1937.01 1587.75,1908.66 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1505.51 121.89,1505.51 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1127.5 121.89,1127.5 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,749.482 121.89,749.482 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,371.468 121.89,371.468 
  "/>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 168.955, 1989.01)" x="168.955" y="1989.01">153</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 641.887, 1989.01)" x="641.887" y="1989.01">154</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1114.82, 1989.01)" x="1114.82" y="1989.01">155</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1587.75, 1989.01)" x="1587.75" y="1989.01">156</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.0</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1523.01)" x="74.4882" y="1523.01">0.2</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1145)" x="74.4882" y="1145">0.4</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 766.982)" x="74.4882" y="766.982">0.6</text>
</g>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 388.968)" x="74.4882" y="388.968">0.8</text>
</g>
<polyline clip-path="url(#clip2902)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.51 180.83,1883.48 189.49,1883.41 198.15,1883.3 206.81,1883.11 215.47,1882.83 224.131,1882.46 
  232.791,1881.98 241.451,1881.39 250.111,1880.62 258.771,1879.6 267.431,1878.31 276.091,1876.76 284.752,1875.03 293.412,1873.13 302.072,1870.98 310.732,1868.48 
  319.392,1865.65 328.052,1862.79 336.713,1860.31 345.373,1858.53 354.033,1857.34 362.693,1856.23 371.353,1854.58 380.013,1851.83 388.673,1847.52 397.334,1841.17 
  405.994,1832.5 414.654,1821.79 423.314,1810.04 431.974,1798.52 440.634,1787.84 449.294,1777.4 457.955,1766.01 466.615,1753.06 475.275,1739.13 483.935,1725.11 
  492.595,1710.91 501.255,1695.13 509.915,1676.53 518.576,1655.55 527.236,1634.04 535.896,1613.15 544.556,1591.71 553.216,1567.33 561.876,1539.48 570.537,1510.96 
  579.197,1485.71 587.857,1464.83 596.517,1445.09 605.177,1421.96 613.837,1393.87 622.497,1362.78 631.158,1330.38 639.818,1294.57 648.478,1251.08 657.138,1199.06 
  665.798,1143.85 674.458,1092.76 683.118,1047.6 691.779,1002.55 700.439,950.755 709.099,892.678 717.759,836.535 726.419,789.314 735.079,748.371 743.739,703.83 
  752.4,650.052 761.06,593.272 769.72,545.856 778.38,512.782 787.04,485.575 795.7,451.181 804.361,406.02 813.021,359.031 821.681,320.008 830.341,287.052 
  839.001,248.79 847.661,199.9 856.321,152.031 864.982,126.017 873.642,132.181 882.302,159.732 890.962,186.807 899.622,200.065 908.282,202.679 916.942,203.659 
  925.603,202.939 934.263,190.718 942.923,161.622 951.583,125.842 960.243,102.378 968.903,100.728 977.563,111.777 986.224,118.888 994.884,117.146 1003.54,119.133 
  1012.2,140.852 1020.86,183.849 1029.52,233.582 1038.18,275.356 1046.84,309.478 1055.5,348.945 1064.16,403.245 1072.83,467.167 1081.49,526.771 1090.15,574.749 
  1098.81,617.479 1107.47,666.584 1116.13,725.571 1124.79,786.651 1133.45,840.317 1142.11,885.905 1150.77,931.355 1159.43,983.406 1168.09,1039.96 1176.75,1092.77 
  1185.41,1136.55 1194.07,1173.82 1202.73,1210.86 1211.39,1250.33 1220.05,1289.13 1228.71,1323.24 1237.37,1353.34 1246.03,1384.6 1254.69,1421.28 1263.35,1462.35 
  1272.01,1502.62 1280.67,1537.75 1289.33,1567.49 1297.99,1594.4 1306.65,1620.32 1315.31,1644.62 1323.97,1665.77 1332.63,1683.67 1341.29,1700.02 1349.95,1716.52 
  1358.61,1733.23 1367.27,1748.74 1375.93,1761.79 1384.59,1772.41 1393.25,1781.5 1401.91,1789.71 1410.57,1796.98 1419.23,1803.02 1427.89,1808.1 1436.55,1813.06 
  1445.21,1818.53 1453.87,1824.45 1462.53,1830.17 1471.19,1835.22 1479.85,1839.7 1488.51,1844.03 1497.17,1848.48 1505.83,1852.9 1514.49,1856.92 1523.15,1860.36 
  1531.81,1863.34 1540.47,1866.08 1549.13,1868.67 1557.79,1871.02 1566.45,1873.03 1575.11,1874.7 1583.77,1876.12 1592.43,1877.41 1601.09,1878.58 1609.75,1879.59 
  1618.41,1880.38 1627.07,1880.94 1635.73,1881.3 1644.39,1881.51 1653.06,1881.64 1661.72,1881.72 1670.38,1881.83 1679.04,1882.01 1687.7,1882.25 1696.36,1882.54 
  1705.02,1882.8 1713.68,1882.98 1722.34,1883.02 1731,1882.93 1739.66,1882.73 1748.32,1882.48 1756.98,1882.26 1765.64,1882.14 1774.3,1882.17 1782.96,1882.34 
  1791.62,1882.6 1800.28,1882.88 1808.94,1883.13 1817.6,1883.3 1826.26,1883.42 1834.92,1883.48 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip2900)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip2900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip2900)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip2900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><p>Density of sigma</p><div><pre><code class="language-julia">density(samples[:sigma])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip3000">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip3000)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip3001">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip3000)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip3002">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  436.696,1937.01 436.696,47.2441 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  796.394,1937.01 796.394,47.2441 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1156.09,1937.01 1156.09,47.2441 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1515.79,1937.01 1515.79,47.2441 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1875.49,1937.01 1875.49,47.2441 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1614.45 1921.26,1614.45 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1345.37 1921.26,1345.37 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1076.29 1921.26,1076.29 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,807.206 1921.26,807.206 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,538.126 1921.26,538.126 
  "/>
<polyline clip-path="url(#clip3002)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,269.047 1921.26,269.047 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  436.696,1937.01 436.696,1908.66 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  796.394,1937.01 796.394,1908.66 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1156.09,1937.01 1156.09,1908.66 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1515.79,1937.01 1515.79,1908.66 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1875.49,1937.01 1875.49,1908.66 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1614.45 121.89,1614.45 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1345.37 121.89,1345.37 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1076.29 121.89,1076.29 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,807.206 121.89,807.206 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,538.126 121.89,538.126 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,269.047 121.89,269.047 
  "/>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 436.696, 1989.01)" x="436.696" y="1989.01">7.0</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 796.394, 1989.01)" x="796.394" y="1989.01">7.5</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1156.09, 1989.01)" x="1156.09" y="1989.01">8.0</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1515.79, 1989.01)" x="1515.79" y="1989.01">8.5</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1875.49, 1989.01)" x="1875.49" y="1989.01">9.0</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.0</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1631.95)" x="74.4882" y="1631.95">0.2</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1362.87)" x="74.4882" y="1362.87">0.4</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1093.79)" x="74.4882" y="1093.79">0.6</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 824.706)" x="74.4882" y="824.706">0.8</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 555.626)" x="74.4882" y="555.626">1.0</text>
</g>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 286.547)" x="74.4882" y="286.547">1.2</text>
</g>
<polyline clip-path="url(#clip3002)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.52 180.83,1883.5 189.49,1883.48 198.15,1883.43 206.81,1883.34 215.47,1883.21 224.131,1883.03 
  232.791,1882.79 241.451,1882.49 250.111,1882.14 258.771,1881.75 267.431,1881.28 276.091,1880.72 284.752,1880.04 293.412,1879.23 302.072,1878.34 310.732,1877.42 
  319.392,1876.55 328.052,1875.72 336.713,1874.83 345.373,1873.71 354.033,1872.12 362.693,1869.9 371.353,1866.99 380.013,1863.49 388.673,1859.6 397.334,1855.54 
  405.994,1851.4 414.654,1847.08 423.314,1842.28 431.974,1836.61 440.634,1829.76 449.294,1821.6 457.955,1812.28 466.615,1802.21 475.275,1791.92 483.935,1781.87 
  492.595,1772.33 501.255,1763.2 509.915,1754.09 518.576,1744.29 527.236,1733.04 535.896,1719.68 544.556,1703.84 553.216,1685.51 561.876,1665.02 570.537,1642.83 
  579.197,1619.34 587.857,1594.73 596.517,1568.92 605.177,1541.64 613.837,1512.63 622.497,1481.8 631.158,1449.27 639.818,1415.37 648.478,1380.47 657.138,1344.83 
  665.798,1308.45 674.458,1271.01 683.118,1231.97 691.779,1190.75 700.439,1146.98 709.099,1100.63 717.759,1052 726.419,1001.58 735.079,949.766 743.739,896.777 
  752.4,842.675 761.06,787.563 769.72,731.828 778.38,676.28 787.04,622.104 795.7,570.631 804.361,523.023 813.021,479.981 821.681,441.572 830.341,407.206 
  839.001,375.798 847.661,346.058 856.321,316.869 864.982,287.616 873.642,258.37 882.302,229.839 890.962,203.123 899.622,179.359 908.282,159.379 916.942,143.492 
  925.603,131.425 934.263,122.448 942.923,115.647 951.583,110.236 960.243,105.82 968.903,102.489 977.563,100.728 986.224,101.178 994.884,104.372 1003.54,110.565 
  1012.2,119.708 1020.86,131.55 1029.52,145.78 1038.18,162.104 1046.84,180.253 1055.5,199.955 1064.16,220.946 1072.83,243.051 1081.49,266.3 1090.15,291.015 
  1098.81,317.784 1107.47,347.339 1116.13,380.387 1124.79,417.451 1133.45,458.766 1142.11,504.212 1150.77,553.232 1159.43,604.792 1168.09,657.43 1176.75,709.505 
  1185.41,759.596 1194.07,806.93 1202.73,851.588 1211.39,894.392 1220.05,936.469 1228.71,978.736 1237.37,1021.53 1246.03,1064.54 1254.69,1107.02 1263.35,1148.1 
  1272.01,1187.13 1280.67,1223.8 1289.33,1258.22 1297.99,1290.79 1306.65,1322.1 1315.31,1352.73 1323.97,1383.03 1332.63,1412.99 1341.29,1442.25 1349.95,1470.25 
  1358.61,1496.42 1367.27,1520.49 1375.93,1542.52 1384.59,1562.96 1393.25,1582.39 1401.91,1601.4 1410.57,1620.35 1419.23,1639.33 1427.89,1658.15 1436.55,1676.42 
  1445.21,1693.68 1453.87,1709.51 1462.53,1723.63 1471.19,1735.9 1479.85,1746.39 1488.51,1755.28 1497.17,1762.85 1505.83,1769.48 1514.49,1775.52 1523.15,1781.35 
  1531.81,1787.24 1540.47,1793.34 1549.13,1799.68 1557.79,1806.17 1566.45,1812.63 1575.11,1818.9 1583.77,1824.81 1592.43,1830.26 1601.09,1835.16 1609.75,1839.51 
  1618.41,1843.31 1627.07,1846.66 1635.73,1849.7 1644.39,1852.58 1653.06,1855.44 1661.72,1858.32 1670.38,1861.15 1679.04,1863.78 1687.7,1866.05 1696.36,1867.89 
  1705.02,1869.3 1713.68,1870.39 1722.34,1871.35 1731,1872.35 1739.66,1873.5 1748.32,1874.84 1756.98,1876.34 1765.64,1877.88 1774.3,1879.34 1782.96,1880.61 
  1791.62,1881.63 1800.28,1882.37 1808.94,1882.87 1817.6,1883.18 1826.26,1883.36 1834.92,1883.45 1843.58,1883.49 1852.24,1883.51 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip3000)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip3000)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip3000)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip3000)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
</div><h3><a class="nav-anchor" id="Snippet-4.20-1" href="#Snippet-4.20-1">Snippet 4.20</a></h3><p>Hdp mu</p><div><pre><code class="language-julia">MCMCChain.hpd(samples[:mu])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 153.66834170854273
 155.27638190954775</code></pre></div><p>Hdp sigma</p><div><pre><code class="language-julia">MCMCChain.hpd(samples[:sigma])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 7.190954773869347
 8.321608040201005</code></pre></div><p>End of <code>clip-14-20.jl</code></p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../clip-07-13s/"><span class="direction">Previous</span><span class="title">clip-07-13s</span></a><a class="next" href="../clip-21-23/"><span class="direction">Next</span><span class="title">clip-21-23</span></a></footer></article></body></html>
