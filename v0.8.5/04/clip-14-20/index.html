<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>clip-14-20 · StatisticalRethinking.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>StatisticalRethinking.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../intro/">Home</a></li><li><a class="toctext" href="../../layout/">Layout</a></li><li><a class="toctext" href="../../versions/">Versions</a></li><li><a class="toctext" href="../../acknowledgements/">Acknowledgements</a></li><li><a class="toctext" href="../../references/">References</a></li><li><span class="toctext">Chapter 00</span><ul><li><a class="toctext" href="../../00/clip-01-03/">clip-01-03</a></li><li><a class="toctext" href="../../00/clip-04-05/">clip-04-05</a></li></ul></li><li><span class="toctext">Chapter 02</span><ul><li><a class="toctext" href="../../02/clip-01-02/">clip-01-02</a></li><li><a class="toctext" href="../../02/clip-03-05/">clip-03-05</a></li><li><a class="toctext" href="../../02/clip-06-07/">clip-06-07</a></li><li><a class="toctext" href="../../02/clip-08/">clip-08</a></li><li><a class="toctext" href="../../02/m2.1s/">m2.1s</a></li></ul></li><li><span class="toctext">Chapter 03</span><ul><li><a class="toctext" href="../../03/clip-01/">clip-01</a></li><li><a class="toctext" href="../../03/clip-02-05/">clip-02-05</a></li><li><a class="toctext" href="../../03/clip-05s/">clip-05s</a></li><li><a class="toctext" href="../../03/clip-06-10/">clip-06-10</a></li><li><a class="toctext" href="../../03/clip-11-16/">clip-11-16</a></li><li><a class="toctext" href="../../03/clip-17s/">clip-17s</a></li></ul></li><li><span class="toctext">Chapter 04</span><ul><li><a class="toctext" href="../m4.1s/">m4.1s</a></li><li><a class="toctext" href="../clip-01-06/">clip-01-06</a></li><li><a class="toctext" href="../clip-07-13s/">clip-07-13s</a></li><li class="current"><a class="toctext" href>clip-14-20</a><ul class="internal"></ul></li><li><a class="toctext" href="../clip-21-23/">clip-21-23</a></li><li><a class="toctext" href="../clip-24-29s/">clip-24-29s</a></li><li><a class="toctext" href="../clip-30s/">clip-30s</a></li><li><a class="toctext" href="../clip-38s/">clip-38s</a></li><li><a class="toctext" href="../clip-43s/">clip-43s</a></li><li><a class="toctext" href="../clip-45-47s/">clip-45-47s</a></li><li><a class="toctext" href="../clip-48-54s/">clip-48-54s</a></li></ul></li><li><a class="toctext" href="../../">Functions</a></li></ul></nav><article id="docs"><header><nav><ul><li>Chapter 04</li><li><a href>clip-14-20</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/StatisticalRethinking.jl/blob/master/scripts/04/clip-14-20.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>clip-14-20</span><a class="fa fa-bars" href="#"></a></div></header><p>Load Julia packages (libraries) needed  for the snippets in chapter 0</p><pre><code class="language-julia">using StatisticalRethinking, CmdStan
gr(size=(500,500));</code></pre><pre><code class="language-none">Plots.GRBackend()</code></pre><p>CmdStan uses a tmp directory to store the output of cmdstan</p><pre><code class="language-julia">ProjDir = rel_path(&quot;..&quot;, &quot;scripts&quot;, &quot;04&quot;)
cd(ProjDir)</code></pre><h3><a class="nav-anchor" id="snippet-4.7-1" href="#snippet-4.7-1">snippet 4.7</a></h3><pre><code class="language-julia">howell1 = CSV.read(rel_path(&quot;..&quot;, &quot;data&quot;, &quot;Howell1.csv&quot;), delim=&#39;;&#39;)
df = convert(DataFrame, howell1);</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>544 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr><tr><th>6</th><td>163.83</td><td>62.9926</td><td>35.0</td><td>1</td></tr><tr><th>7</th><td>149.225</td><td>38.2435</td><td>32.0</td><td>0</td></tr><tr><th>8</th><td>168.91</td><td>55.48</td><td>27.0</td><td>1</td></tr><tr><th>9</th><td>147.955</td><td>34.8699</td><td>19.0</td><td>0</td></tr><tr><th>10</th><td>165.1</td><td>54.4877</td><td>54.0</td><td>1</td></tr><tr><th>11</th><td>154.305</td><td>49.8951</td><td>47.0</td><td>0</td></tr><tr><th>12</th><td>151.13</td><td>41.2202</td><td>66.0</td><td>1</td></tr><tr><th>13</th><td>144.78</td><td>36.0322</td><td>73.0</td><td>0</td></tr><tr><th>14</th><td>149.9</td><td>47.7</td><td>20.0</td><td>0</td></tr><tr><th>15</th><td>150.495</td><td>33.8493</td><td>65.3</td><td>0</td></tr><tr><th>16</th><td>163.195</td><td>48.5627</td><td>36.0</td><td>1</td></tr><tr><th>17</th><td>157.48</td><td>42.3258</td><td>44.0</td><td>1</td></tr><tr><th>18</th><td>143.942</td><td>38.3569</td><td>31.0</td><td>0</td></tr><tr><th>19</th><td>121.92</td><td>19.6179</td><td>12.0</td><td>1</td></tr><tr><th>20</th><td>105.41</td><td>13.948</td><td>8.0</td><td>0</td></tr><tr><th>21</th><td>86.36</td><td>10.4893</td><td>6.5</td><td>0</td></tr><tr><th>22</th><td>161.29</td><td>48.9879</td><td>39.0</td><td>1</td></tr><tr><th>23</th><td>156.21</td><td>42.7227</td><td>29.0</td><td>0</td></tr><tr><th>24</th><td>129.54</td><td>23.5868</td><td>13.0</td><td>1</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table><h3><a class="nav-anchor" id="snippet-4.8-1" href="#snippet-4.8-1">snippet 4.8</a></h3><p>Use only adults</p><pre><code class="language-julia">df2 = filter(row -&gt; row[:age] &gt;= 18, df);</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>352 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr><tr><th>6</th><td>163.83</td><td>62.9926</td><td>35.0</td><td>1</td></tr><tr><th>7</th><td>149.225</td><td>38.2435</td><td>32.0</td><td>0</td></tr><tr><th>8</th><td>168.91</td><td>55.48</td><td>27.0</td><td>1</td></tr><tr><th>9</th><td>147.955</td><td>34.8699</td><td>19.0</td><td>0</td></tr><tr><th>10</th><td>165.1</td><td>54.4877</td><td>54.0</td><td>1</td></tr><tr><th>11</th><td>154.305</td><td>49.8951</td><td>47.0</td><td>0</td></tr><tr><th>12</th><td>151.13</td><td>41.2202</td><td>66.0</td><td>1</td></tr><tr><th>13</th><td>144.78</td><td>36.0322</td><td>73.0</td><td>0</td></tr><tr><th>14</th><td>149.9</td><td>47.7</td><td>20.0</td><td>0</td></tr><tr><th>15</th><td>150.495</td><td>33.8493</td><td>65.3</td><td>0</td></tr><tr><th>16</th><td>163.195</td><td>48.5627</td><td>36.0</td><td>1</td></tr><tr><th>17</th><td>157.48</td><td>42.3258</td><td>44.0</td><td>1</td></tr><tr><th>18</th><td>143.942</td><td>38.3569</td><td>31.0</td><td>0</td></tr><tr><th>19</th><td>161.29</td><td>48.9879</td><td>39.0</td><td>1</td></tr><tr><th>20</th><td>156.21</td><td>42.7227</td><td>29.0</td><td>0</td></tr><tr><th>21</th><td>146.4</td><td>35.4936</td><td>56.0</td><td>1</td></tr><tr><th>22</th><td>148.59</td><td>37.9033</td><td>45.0</td><td>0</td></tr><tr><th>23</th><td>147.32</td><td>35.4652</td><td>19.0</td><td>0</td></tr><tr><th>24</th><td>147.955</td><td>40.313</td><td>29.0</td><td>1</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table><p>Show first 5 rows of DataFrame df</p><pre><code class="language-julia">first(df2, 5)</code></pre><table class="data-frame"><thead><tr><th></th><th>height</th><th>weight</th><th>age</th><th>male</th></tr><tr><th></th><th>Float64⍰</th><th>Float64⍰</th><th>Float64⍰</th><th>Int64⍰</th></tr></thead><tbody><p>5 rows × 4 columns</p><tr><th>1</th><td>151.765</td><td>47.8256</td><td>63.0</td><td>1</td></tr><tr><th>2</th><td>139.7</td><td>36.4858</td><td>63.0</td><td>0</td></tr><tr><th>3</th><td>136.525</td><td>31.8648</td><td>65.0</td><td>0</td></tr><tr><th>4</th><td>156.845</td><td>53.0419</td><td>41.0</td><td>1</td></tr><tr><th>5</th><td>145.415</td><td>41.2769</td><td>51.0</td><td>0</td></tr></tbody></table><h3><a class="nav-anchor" id="Snippet-4.14-1" href="#Snippet-4.14-1">Snippet 4.14</a></h3><p>Generate approximate probabilities</p><pre><code class="language-julia">struct Post
  mu::Float64
  sigma::Float64
  ll:: Float64
  prod::Float64
  prob::Float64
end

mu_list = repeat(range(140, 160, length=200), 200);
sigma_list = repeat(range(4, 9, length=200), inner=200);

ll = zeros(40000);
for i in 1:40000
    d1 = Normal(mu_list[i], sigma_list[i])
    ll[i] = sum(log.(pdf.(d1, df2[:height])))
end

d2 = Normal(178.0, 20.0)
d3 = Uniform(0, 50)
prod = ll + log.(pdf.(d2, mu_list)) + log.(pdf.(d3, sigma_list))
prob = exp.(prod .- maximum(prod))
post = DataFrame(mu=mu_list, sigma=sigma_list, ll=ll, prod=prod, prob=prob)
first(post, 10)</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10 rows × 5 columns</p><tr><th>1</th><td>140.0</td><td>4.0</td><td>-3812.78</td><td>-3822.41</td><td>0.0</td></tr><tr><th>2</th><td>140.101</td><td>4.0</td><td>-3780.61</td><td>-3790.23</td><td>0.0</td></tr><tr><th>3</th><td>140.201</td><td>4.0</td><td>-3748.67</td><td>-3758.28</td><td>0.0</td></tr><tr><th>4</th><td>140.302</td><td>4.0</td><td>-3716.95</td><td>-3726.55</td><td>0.0</td></tr><tr><th>5</th><td>140.402</td><td>4.0</td><td>-3685.45</td><td>-3695.05</td><td>0.0</td></tr><tr><th>6</th><td>140.503</td><td>4.0</td><td>-3654.18</td><td>-3663.76</td><td>0.0</td></tr><tr><th>7</th><td>140.603</td><td>4.0</td><td>-3623.13</td><td>-3632.7</td><td>0.0</td></tr><tr><th>8</th><td>140.704</td><td>4.0</td><td>-3592.3</td><td>-3601.86</td><td>0.0</td></tr><tr><th>9</th><td>140.804</td><td>4.0</td><td>-3561.69</td><td>-3571.24</td><td>0.0</td></tr><tr><th>10</th><td>140.905</td><td>4.0</td><td>-3531.3</td><td>-3540.85</td><td>0.0</td></tr></tbody></table><h3><a class="nav-anchor" id="Snippet-4.15-1" href="#Snippet-4.15-1">Snippet 4.15</a></h3><p>Sample post</p><pre><code class="language-julia">samples = post[sample(1:size(post, 1), Weights(post[:prob]), 10000, replace=true), :]</code></pre><table class="data-frame"><thead><tr><th></th><th>mu</th><th>sigma</th><th>ll</th><th>prod</th><th>prob</th></tr><tr><th></th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>10,000 rows × 5 columns</p><tr><th>1</th><td>153.869</td><td>7.61809</td><td>-1221.09</td><td>-1229.64</td><td>0.178581</td></tr><tr><th>2</th><td>154.774</td><td>8.37186</td><td>-1221.6</td><td>-1230.1</td><td>0.112993</td></tr><tr><th>3</th><td>154.171</td><td>8.19598</td><td>-1221.03</td><td>-1229.57</td><td>0.191893</td></tr><tr><th>4</th><td>154.673</td><td>7.76884</td><td>-1219.43</td><td>-1227.94</td><td>0.983449</td></tr><tr><th>5</th><td>153.97</td><td>7.39196</td><td>-1221.4</td><td>-1229.95</td><td>0.131157</td></tr><tr><th>6</th><td>154.573</td><td>7.61809</td><td>-1219.48</td><td>-1228.0</td><td>0.92631</td></tr><tr><th>7</th><td>154.975</td><td>7.79397</td><td>-1219.84</td><td>-1228.33</td><td>0.663428</td></tr><tr><th>8</th><td>154.472</td><td>7.76884</td><td>-1219.46</td><td>-1227.98</td><td>0.944722</td></tr><tr><th>9</th><td>154.975</td><td>7.54271</td><td>-1220.06</td><td>-1228.55</td><td>0.530547</td></tr><tr><th>10</th><td>154.271</td><td>7.61809</td><td>-1219.8</td><td>-1228.33</td><td>0.660794</td></tr><tr><th>11</th><td>154.874</td><td>7.74372</td><td>-1219.63</td><td>-1228.13</td><td>0.813517</td></tr><tr><th>12</th><td>155.477</td><td>7.84422</td><td>-1221.69</td><td>-1230.16</td><td>0.106972</td></tr><tr><th>13</th><td>153.97</td><td>7.9196</td><td>-1220.71</td><td>-1229.26</td><td>0.262446</td></tr><tr><th>14</th><td>154.07</td><td>7.51759</td><td>-1220.55</td><td>-1229.09</td><td>0.309407</td></tr><tr><th>15</th><td>154.774</td><td>7.71859</td><td>-1219.5</td><td>-1228.0</td><td>0.924106</td></tr><tr><th>16</th><td>154.874</td><td>7.9196</td><td>-1219.82</td><td>-1228.32</td><td>0.672931</td></tr><tr><th>17</th><td>154.975</td><td>6.98995</td><td>-1223.75</td><td>-1232.24</td><td>0.0133239</td></tr><tr><th>18</th><td>154.774</td><td>7.84422</td><td>-1219.57</td><td>-1228.07</td><td>0.862171</td></tr><tr><th>19</th><td>154.472</td><td>7.44221</td><td>-1219.98</td><td>-1228.5</td><td>0.561437</td></tr><tr><th>20</th><td>154.372</td><td>7.79397</td><td>-1219.57</td><td>-1228.1</td><td>0.836123</td></tr><tr><th>21</th><td>153.869</td><td>7.56784</td><td>-1221.2</td><td>-1229.75</td><td>0.16044</td></tr><tr><th>22</th><td>154.874</td><td>7.99497</td><td>-1220.0</td><td>-1228.5</td><td>0.560667</td></tr><tr><th>23</th><td>154.774</td><td>7.61809</td><td>-1219.58</td><td>-1228.08</td><td>0.854009</td></tr><tr><th>24</th><td>154.472</td><td>7.94472</td><td>-1219.7</td><td>-1228.22</td><td>0.738648</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table><h3><a class="nav-anchor" id="Snippet-4.19-1" href="#Snippet-4.19-1">Snippet 4.19</a></h3><p>Density of mu</p><pre><code class="language-julia">density(samples[:mu])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip6700">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6700)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6701">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6700)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6702">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  264.016,1937.01 264.016,47.2441 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  736.948,1937.01 736.948,47.2441 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1209.88,1937.01 1209.88,47.2441 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1682.81,1937.01 1682.81,47.2441 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1432.29 1921.26,1432.29 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,981.053 1921.26,981.053 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,529.817 1921.26,529.817 
  "/>
<polyline clip-path="url(#clip6702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,78.5813 1921.26,78.5813 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  264.016,1937.01 264.016,1908.66 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  736.948,1937.01 736.948,1908.66 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1209.88,1937.01 1209.88,1908.66 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1682.81,1937.01 1682.81,1908.66 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1432.29 121.89,1432.29 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,981.053 121.89,981.053 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,529.817 121.89,529.817 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,78.5813 121.89,78.5813 
  "/>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 264.016, 1989.01)" x="264.016" y="1989.01">153</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 736.948, 1989.01)" x="736.948" y="1989.01">154</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1209.88, 1989.01)" x="1209.88" y="1989.01">155</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1682.81, 1989.01)" x="1682.81" y="1989.01">156</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.00</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1449.79)" x="74.4882" y="1449.79">0.25</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 998.553)" x="74.4882" y="998.553">0.50</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 547.317)" x="74.4882" y="547.317">0.75</text>
</g>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 96.0813)" x="74.4882" y="96.0813">1.00</text>
</g>
<polyline clip-path="url(#clip6702)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.51 180.83,1883.48 189.49,1883.42 198.15,1883.31 206.81,1883.14 215.47,1882.9 224.131,1882.62 
  232.791,1882.33 241.451,1882.08 250.111,1881.91 258.771,1881.81 267.431,1881.74 276.091,1881.66 284.752,1881.51 293.412,1881.28 302.072,1880.94 310.732,1880.46 
  319.392,1879.86 328.052,1879.19 336.713,1878.53 345.373,1877.9 354.033,1877.28 362.693,1876.57 371.353,1875.7 380.013,1874.66 388.673,1873.44 397.334,1871.96 
  405.994,1870.1 414.654,1867.81 423.314,1865.15 431.974,1862.24 440.634,1859.06 449.294,1855.39 457.955,1850.97 466.615,1845.79 475.275,1840.16 483.935,1834.38 
  492.595,1828.32 501.255,1821.54 509.915,1813.76 518.576,1805.4 527.236,1797.41 535.896,1790.35 544.556,1783.81 553.216,1776.63 561.876,1768.03 570.537,1758.1 
  579.197,1747.35 587.857,1735.57 596.517,1721.65 605.177,1704.76 613.837,1685.49 622.497,1665.49 631.158,1645.6 639.818,1624.52 648.478,1600 657.138,1571.47 
  665.798,1541.2 674.458,1512.16 683.118,1484.7 691.779,1455.81 700.439,1422.47 709.099,1385.5 717.759,1349.21 726.419,1316.69 735.079,1285.81 743.739,1250.95 
  752.4,1209.03 761.06,1163.08 769.72,1118.67 778.38,1076.99 787.04,1032.86 795.7,980.868 804.361,923.048 813.021,868.687 821.681,825.21 830.341,789.946 
  839.001,752.645 847.661,706.797 856.321,657.214 864.982,614.755 873.642,583.68 882.302,556.224 890.962,521.19 899.622,477.056 908.282,434.17 916.942,402.901 
  925.603,381.217 934.263,356.589 942.923,320.781 951.583,280.593 960.243,251.526 968.903,240.818 977.563,239.08 986.224,230.299 994.884,208.9 1003.54,184.336 
  1012.2,168.246 1020.86,159.799 1029.52,147.127 1038.18,123.835 1046.84,101.211 1055.5,100.728 1064.16,133.676 1072.83,189.75 1081.49,246.839 1090.15,291.01 
  1098.81,325.34 1107.47,359.998 1116.13,397.114 1124.79,428.439 1133.45,447.462 1142.11,460.449 1150.77,482.511 1159.43,522.727 1168.09,575.151 1176.75,625.693 
  1185.41,666.848 1194.07,703.974 1202.73,747.166 1211.39,799.005 1220.05,852.049 1228.71,897.957 1237.37,936.983 1246.03,977.152 1254.69,1024.76 1263.35,1077.4 
  1272.01,1126.92 1280.67,1168.18 1289.33,1203.54 1297.99,1238.83 1306.65,1276.32 1315.31,1312.79 1323.97,1344.29 1332.63,1371.37 1341.29,1398.71 1349.95,1430.11 
  1358.61,1464.52 1367.27,1497.49 1375.93,1525.88 1384.59,1550.49 1393.25,1574.3 1401.91,1598.79 1410.57,1622.7 1419.23,1644 1427.89,1662.56 1436.55,1680.34 
  1445.21,1699.21 1453.87,1719.05 1462.53,1738.02 1471.19,1754.48 1479.85,1768.27 1488.51,1780.4 1497.17,1791.66 1505.83,1801.97 1514.49,1810.82 1523.15,1818.1 
  1531.81,1824.3 1540.47,1830 1549.13,1835.33 1557.79,1840.07 1566.45,1844.03 1575.11,1847.43 1583.77,1850.68 1592.43,1853.99 1601.09,1857.24 1609.75,1860.2 
  1618.41,1862.81 1627.07,1865.24 1635.73,1867.7 1644.39,1870.2 1653.06,1872.54 1661.72,1874.48 1670.38,1875.88 1679.04,1876.73 1687.7,1877.12 1696.36,1877.19 
  1705.02,1877.1 1713.68,1877.07 1722.34,1877.28 1731,1877.81 1739.66,1878.6 1748.32,1879.5 1756.98,1880.34 1765.64,1881.05 1774.3,1881.64 1782.96,1882.12 
  1791.62,1882.53 1800.28,1882.87 1808.94,1883.13 1817.6,1883.31 1826.26,1883.42 1834.92,1883.48 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip6700)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip6700)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip6700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
<p>Density of sigma</p><pre><code class="language-julia">density(samples[:sigma])</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="500" height="500" viewBox="0 0 2000 2000">
<defs>
  <clipPath id="clip6900">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6900)" points="
0,2000 2000,2000 2000,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6901">
    <rect x="400" y="200" width="1401" height="1401"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip6900)" points="
94.4882,1937.01 1921.26,1937.01 1921.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip6902">
    <rect x="94" y="47" width="1828" height="1891"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  410.758,1937.01 410.758,47.2441 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  759.222,1937.01 759.222,47.2441 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1107.69,1937.01 1107.69,47.2441 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1456.15,1937.01 1456.15,47.2441 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1804.61,1937.01 1804.61,47.2441 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1883.52 1921.26,1883.52 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1616.73 1921.26,1616.73 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1349.94 1921.26,1349.94 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1083.15 1921.26,1083.15 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,816.365 1921.26,816.365 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,549.575 1921.26,549.575 
  "/>
<polyline clip-path="url(#clip6902)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,282.785 1921.26,282.785 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 1921.26,1937.01 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1937.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  410.758,1937.01 410.758,1908.66 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  759.222,1937.01 759.222,1908.66 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1107.69,1937.01 1107.69,1908.66 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1456.15,1937.01 1456.15,1908.66 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1804.61,1937.01 1804.61,1908.66 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1883.52 121.89,1883.52 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1616.73 121.89,1616.73 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1349.94 121.89,1349.94 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1083.15 121.89,1083.15 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,816.365 121.89,816.365 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,549.575 121.89,549.575 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,282.785 121.89,282.785 
  "/>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 410.758, 1989.01)" x="410.758" y="1989.01">7.0</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 759.222, 1989.01)" x="759.222" y="1989.01">7.5</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1107.69, 1989.01)" x="1107.69" y="1989.01">8.0</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1456.15, 1989.01)" x="1456.15" y="1989.01">8.5</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1804.61, 1989.01)" x="1804.61" y="1989.01">9.0</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1901.02)" x="74.4882" y="1901.02">0.0</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1634.23)" x="74.4882" y="1634.23">0.2</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1367.44)" x="74.4882" y="1367.44">0.4</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 1100.65)" x="74.4882" y="1100.65">0.6</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 833.865)" x="74.4882" y="833.865">0.8</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 567.075)" x="74.4882" y="567.075">1.0</text>
</g>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 74.4882, 300.285)" x="74.4882" y="300.285">1.2</text>
</g>
<polyline clip-path="url(#clip6902)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  146.189,1883.52 154.849,1883.52 163.51,1883.52 172.17,1883.51 180.83,1883.49 189.49,1883.46 198.15,1883.38 206.81,1883.25 215.47,1883.02 224.131,1882.67 
  232.791,1882.17 241.451,1881.5 250.111,1880.66 258.771,1879.66 267.431,1878.54 276.091,1877.37 284.752,1876.23 293.412,1875.23 302.072,1874.44 310.732,1873.92 
  319.392,1873.62 328.052,1873.41 336.713,1873.05 345.373,1872.23 354.033,1870.65 362.693,1868.07 371.353,1864.32 380.013,1859.35 388.673,1853.2 397.334,1846 
  405.994,1837.97 414.654,1829.39 423.314,1820.54 431.974,1811.59 440.634,1802.57 449.294,1793.25 457.955,1783.23 466.615,1772.08 475.275,1759.43 483.935,1745.12 
  492.595,1729.2 501.255,1711.87 509.915,1693.41 518.576,1674.11 527.236,1654.2 535.896,1633.89 544.556,1613.23 553.216,1592.15 561.876,1570.36 570.537,1547.38 
  579.197,1522.64 587.857,1495.64 596.517,1466.14 605.177,1434.22 613.837,1400.11 622.497,1364.06 631.158,1326.04 639.818,1285.74 648.478,1242.69 657.138,1196.5 
  665.798,1147.1 674.458,1094.93 683.118,1040.92 691.779,986.423 700.439,932.841 709.099,881.346 717.759,832.518 726.419,786.16 735.079,741.355 743.739,696.791 
  752.4,651.305 761.06,604.427 769.72,556.715 778.38,509.694 787.04,465.4 795.7,425.692 804.361,391.614 813.021,363.041 821.681,338.725 830.341,316.726 
  839.001,295.031 847.661,272.172 856.321,247.608 864.982,221.795 873.642,195.949 882.302,171.617 890.962,150.206 899.622,132.63 908.282,119.169 916.942,109.604 
  925.603,103.534 934.263,100.728 942.923,101.324 951.583,105.788 960.243,114.687 968.903,128.456 977.563,147.247 986.224,170.891 994.884,198.871 1003.54,230.272 
  1012.2,263.772 1020.86,297.787 1029.52,330.806 1038.18,361.828 1046.84,390.684 1055.5,418.098 1064.16,445.447 1072.83,474.295 1081.49,505.871 1090.15,540.634 
  1098.81,578.067 1107.47,616.779 1116.13,654.958 1124.79,691.071 1133.45,724.566 1142.11,756.258 1150.77,788.155 1159.43,822.722 1168.09,861.892 1176.75,906.266 
  1185.41,954.898 1194.07,1005.73 1202.73,1056.43 1211.39,1105.15 1220.05,1150.97 1228.71,1193.75 1237.37,1233.76 1246.03,1271.23 1254.69,1306.18 1263.35,1338.43 
  1272.01,1367.89 1280.67,1394.73 1289.33,1419.48 1297.99,1442.96 1306.65,1466.04 1315.31,1489.45 1323.97,1513.57 1332.63,1538.35 1341.29,1563.46 1349.95,1588.4 
  1358.61,1612.71 1367.27,1636.14 1375.93,1658.58 1384.59,1680.03 1393.25,1700.44 1401.91,1719.61 1410.57,1737.25 1419.23,1753.01 1427.89,1766.66 1436.55,1778.15 
  1445.21,1787.67 1453.87,1795.55 1462.53,1802.17 1471.19,1807.9 1479.85,1813.03 1488.51,1817.77 1497.17,1822.25 1505.83,1826.55 1514.49,1830.7 1523.15,1834.69 
  1531.81,1838.49 1540.47,1842.11 1549.13,1845.56 1557.79,1848.83 1566.45,1851.93 1575.11,1854.78 1583.77,1857.31 1592.43,1859.48 1601.09,1861.31 1609.75,1862.92 
  1618.41,1864.47 1627.07,1866.14 1635.73,1868.04 1644.39,1870.15 1653.06,1872.37 1661.72,1874.49 1670.38,1876.31 1679.04,1877.68 1687.7,1878.57 1696.36,1879.03 
  1705.02,1879.2 1713.68,1879.23 1722.34,1879.26 1731,1879.39 1739.66,1879.68 1748.32,1880.11 1756.98,1880.65 1765.64,1881.24 1774.3,1881.82 1782.96,1882.34 
  1791.62,1882.75 1800.28,1883.05 1808.94,1883.26 1817.6,1883.39 1826.26,1883.46 1834.92,1883.49 1843.58,1883.51 1852.24,1883.52 1860.9,1883.52 1869.56,1883.52 
  
  "/>
<polygon clip-path="url(#clip6900)" points="
1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip6900)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1610.43,227.724 1861.26,227.724 1861.26,106.764 1610.43,106.764 1610.43,227.724 
  "/>
<polyline clip-path="url(#clip6900)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1630.43,167.244 1750.43,167.244 
  "/>
<g clip-path="url(#clip6900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1770.43, 184.744)" x="1770.43" y="184.744">y1</text>
</g>
</svg>
<h3><a class="nav-anchor" id="Snippet-4.20-1" href="#Snippet-4.20-1">Snippet 4.20</a></h3><p>Hdp mu</p><pre><code class="language-julia">MCMCChains.hpd(samples[:mu])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 153.76884422110552
 155.37688442211055</code></pre><p>Hdp sigma</p><pre><code class="language-julia">MCMCChains.hpd(samples[:sigma])</code></pre><pre><code class="language-none">2-element Array{Float64,1}:
 7.190954773869347
 8.321608040201005</code></pre><p>End of <code>clip-14-20.jl</code></p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../clip-07-13s/"><span class="direction">Previous</span><span class="title">clip-07-13s</span></a><a class="next" href="../clip-21-23/"><span class="direction">Next</span><span class="title">clip-21-23</span></a></footer></article></body></html>
